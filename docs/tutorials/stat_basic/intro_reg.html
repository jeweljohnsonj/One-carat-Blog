<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jewel Johnson">
<meta name="dcterms.date" content="2022-09-02">
<meta name="description" content="Learn the basics of regression in R">

<title>SciQuest - Introduction to Regression in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/social-share-0.1.0/social-share.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/social-share-0.1.0/all.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EVCS615JQR"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-EVCS615JQR', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css">
<meta property="og:title" content="SciQuest - Introduction to Regression in R">
<meta property="og:description" content="Learn the basics of regression in R">
<meta property="og:image" content="https://sciquest.netlify.app/tutorials/stat_basic/images/intro_reg.png">
<meta property="og:site-name" content="SciQuest">
<meta property="og:image:height" content="1080">
<meta property="og:image:width" content="1920">
<meta name="twitter:title" content="SciQuest - Introduction to Regression in R">
<meta name="twitter:description" content="Learn the basics of regression in R">
<meta name="twitter:image" content="https://sciquest.netlify.app/tutorials/stat_basic/images/intro_reg.png">
<meta name="twitter:image-height" content="1080">
<meta name="twitter:image-width" content="1920">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../favicon.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">SciQuest</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://jeweljohnsonj.github.io/jewel_resume/" rel="" target="">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jeweljohnsonj/SciQuest" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jeweljohnsonj" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Introduction to Regression in R</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                  <div>
        <div class="description">
          Learn the basics of regression in R
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">regression</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://sciquest.netlify.app/">Jewel Johnson</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 2, 2022</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">April 17, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">2</span> Linear regression</a></li>
  <li><a href="#making-predicition-using-a-linear-model" id="toc-making-predicition-using-a-linear-model" class="nav-link" data-scroll-target="#making-predicition-using-a-linear-model"><span class="header-section-number">3</span> Making predicition using a linear model</a></li>
  <li><a href="#understanding-the-summary-of-a-linear-model" id="toc-understanding-the-summary-of-a-linear-model" class="nav-link" data-scroll-target="#understanding-the-summary-of-a-linear-model"><span class="header-section-number">4</span> Understanding the summary of a linear model</a></li>
  <li><a href="#getting-the-model-output" id="toc-getting-the-model-output" class="nav-link" data-scroll-target="#getting-the-model-output"><span class="header-section-number">5</span> Getting the model output</a></li>
  <li><a href="#assessing-linear-model-fit" id="toc-assessing-linear-model-fit" class="nav-link" data-scroll-target="#assessing-linear-model-fit"><span class="header-section-number">6</span> Assessing linear model fit</a>
  <ul class="collapse">
  <li><a href="#r-squared-value" id="toc-r-squared-value" class="nav-link" data-scroll-target="#r-squared-value"><span class="header-section-number">6.1</span> R-squared value</a></li>
  <li><a href="#residual-standard-error-rse" id="toc-residual-standard-error-rse" class="nav-link" data-scroll-target="#residual-standard-error-rse"><span class="header-section-number">6.2</span> Residual standard error (RSE)</a></li>
  <li><a href="#root-mean-square-error-rmse" id="toc-root-mean-square-error-rmse" class="nav-link" data-scroll-target="#root-mean-square-error-rmse"><span class="header-section-number">6.3</span> Root mean square error (RMSE)</a></li>
  </ul></li>
  <li><a href="#visualizing-linear-model-fit" id="toc-visualizing-linear-model-fit" class="nav-link" data-scroll-target="#visualizing-linear-model-fit"><span class="header-section-number">7</span> Visualizing linear model fit</a>
  <ul class="collapse">
  <li><a href="#residual-vs.-fitted-plot" id="toc-residual-vs.-fitted-plot" class="nav-link" data-scroll-target="#residual-vs.-fitted-plot"><span class="header-section-number">7.1</span> Residual vs.&nbsp;Fitted plot</a></li>
  <li><a href="#q-q-plot" id="toc-q-q-plot" class="nav-link" data-scroll-target="#q-q-plot"><span class="header-section-number">7.2</span> Q-Q plot</a></li>
  <li><a href="#scale-location-plot" id="toc-scale-location-plot" class="nav-link" data-scroll-target="#scale-location-plot"><span class="header-section-number">7.3</span> Scale-location plot</a></li>
  </ul></li>
  <li><a href="#outliers-leverage-and-influence" id="toc-outliers-leverage-and-influence" class="nav-link" data-scroll-target="#outliers-leverage-and-influence"><span class="header-section-number">8</span> Outliers, leverage, and influence</a>
  <ul class="collapse">
  <li><a href="#leverage" id="toc-leverage" class="nav-link" data-scroll-target="#leverage"><span class="header-section-number">8.1</span> Leverage</a></li>
  <li><a href="#influence" id="toc-influence" class="nav-link" data-scroll-target="#influence"><span class="header-section-number">8.2</span> Influence</a></li>
  <li><a href="#plotting-leverage-and-influence" id="toc-plotting-leverage-and-influence" class="nav-link" data-scroll-target="#plotting-leverage-and-influence"><span class="header-section-number">8.3</span> Plotting leverage and influence</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">9</span> Logistic regression</a></li>
  <li><a href="#making-predictions-using-a-logistic-model" id="toc-making-predictions-using-a-logistic-model" class="nav-link" data-scroll-target="#making-predictions-using-a-logistic-model"><span class="header-section-number">10</span> Making predictions using a logistic model</a>
  <ul class="collapse">
  <li><a href="#probability-values" id="toc-probability-values" class="nav-link" data-scroll-target="#probability-values"><span class="header-section-number">10.1</span> Probability values</a></li>
  <li><a href="#most-likely-outcome" id="toc-most-likely-outcome" class="nav-link" data-scroll-target="#most-likely-outcome"><span class="header-section-number">10.2</span> Most likely outcome</a></li>
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio"><span class="header-section-number">10.3</span> Odds ratio</a></li>
  <li><a href="#log-odds-ratio" id="toc-log-odds-ratio" class="nav-link" data-scroll-target="#log-odds-ratio"><span class="header-section-number">10.4</span> Log odds ratio</a></li>
  </ul></li>
  <li><a href="#understanding-the-summary-of-a-logistic-model" id="toc-understanding-the-summary-of-a-logistic-model" class="nav-link" data-scroll-target="#understanding-the-summary-of-a-logistic-model"><span class="header-section-number">11</span> Understanding the summary of a logistic model</a></li>
  <li><a href="#assessing-logistic-model-fit" id="toc-assessing-logistic-model-fit" class="nav-link" data-scroll-target="#assessing-logistic-model-fit"><span class="header-section-number">12</span> Assessing logistic model fit</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix"><span class="header-section-number">12.1</span> Confusion matrix</a></li>
  <li><a href="#accuracy" id="toc-accuracy" class="nav-link" data-scroll-target="#accuracy"><span class="header-section-number">12.2</span> Accuracy</a></li>
  <li><a href="#sensitivity" id="toc-sensitivity" class="nav-link" data-scroll-target="#sensitivity"><span class="header-section-number">12.3</span> Sensitivity</a></li>
  <li><a href="#specificity" id="toc-specificity" class="nav-link" data-scroll-target="#specificity"><span class="header-section-number">12.4</span> Specificity</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">13</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jeweljohnsonj/SciQuest/edit/main/tutorials/stat_basic/intro_reg.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jeweljohnsonj/SciQuest/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TL;DR
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this article you will learn;</p>
<ol type="1">
<li><p>What is linear regression / linear model</p></li>
<li><p>How to build a linear model and use it to predict</p></li>
<li><p>Understanding the linear model summary output</p></li>
<li><p>How to view model outputs as data frames using the <code>{broom}</code> package</p></li>
<li><p>Assessing linear model performance using; R-squared, Residual standard error and Root mean square error</p></li>
<li><p>Visualizing model fit using; Residual vs.&nbsp;Fitted plot, Q-Q plot and Scale-location plot</p></li>
<li><p>Analysing outliers using; Leverage (hat values) and Influence (cook’s distance)</p></li>
<li><p>What is logistic regression / logistic model</p></li>
<li><p>How to build a logistic model</p></li>
<li><p>Different types of predictions using the logistic model: Probability values, Most like outcomes, Odds ratio and Log odds ratio</p></li>
<li><p>Understanding the logistic model summary output</p></li>
<li><p>Assessing logistic model performance using; Confusion matrix, Accuracy, Sensitivity and Specificity</p></li>
</ol>
</div>
</div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>In this tutorial, we will learn the basics of linear regression and logistic regression using R. We will learn how interpret the model summaries of both of them, how to predict values using models, how to assess and visualize model performance and so on.</p>
</section>
<section id="linear-regression" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">2</span> Linear regression</h2>
<p>Regression models are a part of statistical models which are used to find relationships between variables in a dataset. Linear regression or linear models are the simplest of the models which describe a linear relationship between two variables. Throughout this tutorial (and also in other tutorials) I might use regression and model interchangeably, please don’t get confused and just have it in your mind that they generally mean the same.</p>
<p>We will use the <code>HorsePrices</code> dataset from the <code>{Stat2Data}</code> package in R. The dataset contains the price and related characteristics of horses listed for sale on the internet. Using the dataset, we will see how the price of a horse (<code>Price</code>) changes according to its age (<code>Age</code>) using a linear model. We will plot this association using the <code>geom_smooth()</code> function in the <code>{ggplot2}</code> package in R. But first let us visualize the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(Stat2Data)) <span class="fu">install.packages</span>(<span class="st">'Stat2Data'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let us fit a model to the graph using the <code>geom_smooth()</code> function. To fit a linear model, we will use the <code>method = "lm"</code> argument. By default, the linear trend line comes with confidence intervals, we can disable this by specifying <code>se = F</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting a linear model</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se  =</span> F) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the linear trend line, we can see that there is some evidence suggesting that the price of the horse decreases as they age.</p>
<p>In the above linear regression plot, the relationship between the price of the horse and the age of the horse is described as a straight line which is the feature of linear regression. Thus, this trend line can be described by the equation of the straight line;</p>
<p><span class="math display">y=mx+c</span></p>
<p>Here <span class="math inline">m</span> is the slope and <span class="math inline">c</span> is the y-intercept.</p>
<p>Now let’s try to get the slope and y-intercept values for the model we just plotted. We will use the <code>lm()</code> function to model the regression of price and age of the horses. The syntax for the <code>lm()</code> function is as follows;</p>
<ul>
<li><code>lm(dependent variable ~ independent variable, dataset_name)</code></li>
</ul>
<p>Here, we want to see how the price of the horse, which is the dependent variable, depends on the age of the horse, which is the independent variable. As mentioned before, linear regression is a type of statistical model. So in other words, we can also say that we are building a linear model to predict the price of the horse using the age of the horse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Age, data = HorsePrices)

Coefficients:
(Intercept)          Age  
    29796.8       -415.9  </code></pre>
</div>
</div>
<p>We get two values, an ‘intercept’ value and a value under the column ‘Age’.</p>
<ol type="1">
<li>Here the slope of the line is denoted under the ‘Age’ column and is -415.9</li>
<li>The y-intercept is given under the column intercept and is 29796.8.</li>
</ol>
<p>Now, what do these values mean according to our model? Recall that the slope is the rate of change of y for x. Therefore, the value of -415.9 means that, as the horse ages one year, the price of the horse decreases by 415.9 dollars. Similarly, the y-intercept value is got when the x value is zero. So the intercept value of 29796.8 means that if the horse has an age of 0 years, or a newborn horse has an average price of 29796.8 dollars. The y-intercept and the slopes got from the model output are called the coefficients.</p>
<p>We can also predict the values of the response variable using a categorical explanatory variable. In the earlier case, the age of the horse was a numerical value, and we calculated the slope of it. Then what values do we get for a categorical explanatory variable?</p>
<p>To test this we will use the <code>Hawks</code> dataset from the <code>{Stat2Data}</code> package in R. The dataset contains measurements of three hawk species. We will see if body weight (<code>Weight</code>) is different between the three hawk species (<code>Species</code>). The three different hawk species in this dataset are; CH=Cooper’s, RT=Red-tailed, and SS=Sharp-Shinned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Species, <span class="at">data =</span> Hawks)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Species, data = Hawks)

Coefficients:
(Intercept)    SpeciesRT    SpeciesSS  
      420.5        673.9       -272.5  </code></pre>
</div>
</div>
<p>We got the coefficient values where we have an intercept value and the values for two of the hawk species (RT and SS), so what happened to the third species (CH)? And what do the values for each species mean?</p>
<p>The intercept value shows the mean body weight for the third species (CH) and the rest of the values by their magnitude and sign tell us how greater or less their average body weight is. For example, the average body weight of RT is 420.5 + 673.9 = 1094.4g. We can change the model formula syntax by adding <code>-1</code>, to calculate individual averages for each level in our categorical explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Species <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Hawks)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Species - 1, data = Hawks)

Coefficients:
SpeciesCH  SpeciesRT  SpeciesSS  
    420.5     1094.4      148.0  </code></pre>
</div>
</div>
<p>Thus we essentially get the back the average body masses of all the hawk species in our data. We can cross check this by checking the means individually as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the mean</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>Hawks <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species, Weight) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(Weight, <span class="at">na.rm =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean_weight"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"CH","2":"420.4857"},{"1":"RT","2":"1094.4301"},{"1":"SS","2":"147.9688"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="making-predicition-using-a-linear-model" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="making-predicition-using-a-linear-model"><span class="header-section-number">3</span> Making predicition using a linear model</h2>
<p>One cool use of models is that we can use them to predict values for which data is not available. Let us go back to the first model we created where we have the price of horses predicted by their age. Let us look at the plot again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(Stat2Data)) <span class="fu">install.packages</span>(<span class="st">'Stat2Data'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting a linear model</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se  =</span> F) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have age values from 1 year to 20 years. What if we want to know what the price of the course would be for a 30-year-old horse given the trend seen without collected data? We can know this price with the use of the model we created. Using the <code>predict()</code> function, we can input our model and the value for which we want the prediction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>age_30 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age=</span><span class="fu">c</span>(<span class="dv">30</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting price for a 30 years old horse</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_lm, <span class="at">newdata =</span> age_30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
17320.89 </code></pre>
</div>
</div>
<p>Our model predicts that the price of a 30-year-old horse would be 17320.89 dollars. Therefore, even though we did not have data for a 30-year-old horse, with help of our model, we were able to extrapolate to find the price for the 30-year-old horse.</p>
</section>
<section id="understanding-the-summary-of-a-linear-model" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="understanding-the-summary-of-a-linear-model"><span class="header-section-number">4</span> Understanding the summary of a linear model</h2>
<p>We can use the <code>summary()</code> function to get the results of the linear model. Let us look at what each section in summary means;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/lm_summary_1.png" class="img-fluid"></p>
<ol type="1">
<li><p>In section 1, we have the model formula used for modelling</p></li>
<li><p>In section 2, we have the 1st quartile, median and the 3rd quartile of the residuals. The residual is the distance or difference between the predicted value and the actual value in the dataset. One of the important requirements for a linear model to be applied to a dataset is that the residuals should be normally distributed. We can check if the residuals are normally distributed by looking at this section. For normally distributed residuals, the median should be close to zero and the 1st and 3rd quartiles should have similar absolute values.</p></li>
<li><p>In section 3, we have the y intercept value and the slope for the Age variable. We also have the standard error value and the t-statistics coupled with a corresponding p-value. The level of significance is noted by the number of asterisks.</p></li>
<li><p>In section 4, we can evaluate the model performance. There are mainly two metrics that assess the model fit; the <em>residual standard error</em> and the <em>R-squared value</em>. We will see more about these values later.</p></li>
</ol>
</section>
<section id="getting-the-model-output" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="getting-the-model-output"><span class="header-section-number">5</span> Getting the model output</h2>
<p>Using various functions in the <code>{broom}</code> package in R, we can extract or view different model outputs.</p>
<ol type="1">
<li>We can use the <code>tidy()</code> function to view or save the coefficients of the model as a data frame which is easier to manipulate using different functions in the <code>{dplyr}</code> package.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising coefficients and other metrics as a data frame</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"29796.7868","3":"3952.4881","4":"7.5387416","5":"1.103623e-09"},{"1":"Age","2":"-415.8631","3":"468.8925","4":"-0.8869051","5":"3.795523e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ol start="2" type="1">
<li>We can use the <code>augment()</code> function to return the dataset values with their corresponding fitted value and various other values. The <code>.fitted</code> column contains the fitted values and the <code>.resid</code> column contains the residuals.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising dataset and model output values</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Price"],"name":[1],"type":["int"],"align":["right"]},{"label":["Age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"38000","2":"3.0","3":"28549.20","4":"9450.8026","5":"0.03647777","6":"15106.68","7":"7.785389e-03","8":"0.64131577"},{"1":"40000","2":"5.0","3":"27717.47","4":"12282.5288","5":"0.02434290","6":"15063.01","7":"8.558381e-03","8":"0.82827258"},{"1":"10000","2":"1.0","3":"29380.92","4":"-19380.9237","5":"0.05641641","6":"14890.07","7":"5.279975e-02","8":"-1.32897980"},{"1":"12000","2":"8.0","3":"26469.88","4":"-14469.8818","5":"0.02077267","6":"15021.14","7":"1.006221e-02","8":"-0.97399633"},{"1":"25000","2":"4.0","3":"28133.33","4":"-3133.3343","5":"0.02943486","6":"15164.72","7":"6.805566e-04","8":"-0.21185001"},{"1":"35000","2":"8.0","3":"26469.88","4":"8530.1182","5":"0.02077267","6":"15119.62","7":"3.496823e-03","8":"0.57417910"},{"1":"35000","2":"5.0","3":"27717.47","4":"7282.5288","5":"0.02434290","6":"15133.65","7":"3.008711e-03","8":"0.49109748"},{"1":"12000","2":"17.0","3":"22727.11","4":"-10727.1137","5":"0.11541294","6":"15080.33","7":"3.765107e-02","8":"-0.75970799"},{"1":"22000","2":"4.0","3":"28133.33","4":"-6133.3343","5":"0.02943486","6":"15144.62","7":"2.607619e-03","8":"-0.41468506"},{"1":"25000","2":"6.0","3":"27301.61","4":"-2301.6081","5":"0.02120188","6":"15168.02","7":"2.600693e-04","8":"-0.15495975"},{"1":"40000","2":"7.0","3":"26885.74","4":"13114.2551","5":"0.02001180","6":"15048.26","7":"7.950052e-03","8":"0.88240366"},{"1":"25000","2":"7.0","3":"26885.74","4":"-1885.7449","5":"0.02001180","6":"15169.27","7":"1.643799e-04","8":"-0.12688393"},{"1":"4500","2":"14.0","3":"23974.70","4":"-19474.7031","5":"0.06630769","6":"14884.27","7":"6.399356e-02","8":"-1.34246525"},{"1":"19900","2":"6.0","3":"27301.61","4":"-7401.6081","5":"0.02120188","6":"15132.52","7":"2.689543e-03","8":"-0.49832608"},{"1":"45000","2":"3.0","3":"28549.20","4":"16450.8026","5":"0.03647777","6":"14973.58","7":"2.358941e-02","8":"1.11632415"},{"1":"45000","2":"6.0","3":"27301.61","4":"17698.3919","5":"0.02120188","6":"14945.74","7":"1.537779e-02","8":"1.19157489"},{"1":"48000","2":"6.0","3":"27301.61","4":"20698.3919","5":"0.02120188","6":"14861.74","7":"2.103292e-02","8":"1.39355509"},{"1":"15500","2":"12.0","3":"24806.43","4":"-9306.4293","5":"0.04332558","6":"15108.20","7":"9.095371e-03","8":"-0.63377500"},{"1":"8500","2":"7.0","3":"26885.74","4":"-18385.7449","5":"0.02001180","6":"14927.99","7":"1.562591e-02","8":"-1.23710029"},{"1":"22000","2":"7.0","3":"26885.74","4":"-4885.7449","5":"0.02001180","6":"15154.73","7":"1.103429e-03","8":"-0.32874145"},{"1":"35000","2":"5.0","3":"27717.47","4":"7282.5288","5":"0.02434290","6":"15133.65","7":"3.008711e-03","8":"0.49109748"},{"1":"16000","2":"7.0","3":"26885.74","4":"-10885.7449","5":"0.02001180","6":"15086.79","7":"5.477710e-03","8":"-0.73245649"},{"1":"16000","2":"3.0","3":"28549.20","4":"-12549.1974","5":"0.03647777","6":"15056.78","7":"1.372698e-02","8":"-0.85156770"},{"1":"15000","2":"7.0","3":"26885.74","4":"-11885.7449","5":"0.02001180","6":"15070.40","7":"6.530336e-03","8":"-0.79974233"},{"1":"33000","2":"4.0","3":"28133.33","4":"4866.6657","5":"0.02943486","6":"15154.70","7":"1.641776e-03","8":"0.32904346"},{"1":"20000","2":"14.0","3":"23974.70","4":"-3974.7031","5":"0.06630769","6":"15159.95","7":"2.665655e-03","8":"-0.27399138"},{"1":"25000","2":"6.0","3":"27301.61","4":"-2301.6081","5":"0.02120188","6":"15168.02","7":"2.600693e-04","8":"-0.15495975"},{"1":"30000","2":"8.0","3":"26469.88","4":"3530.1182","5":"0.02077267","6":"15162.89","7":"5.988830e-04","8":"0.23761923"},{"1":"50000","2":"6.0","3":"27301.61","4":"22698.3919","5":"0.02120188","6":"14798.13","7":"2.529394e-02","8":"1.52820855"},{"1":"1100","2":"19.0","3":"21895.39","4":"-20795.3875","5":"0.15790449","6":"14807.35","7":"2.136210e-01","8":"-1.50945594"},{"1":"15000","2":"0.5","3":"29588.86","4":"-14588.8552","5":"0.06262041","6":"15011.77","7":"3.364849e-02","8":"-1.00368531"},{"1":"45000","2":"14.0","3":"23974.70","4":"21025.2969","5":"0.06630769","6":"14836.12","7":"7.458970e-02","8":"1.44935357"},{"1":"2000","2":"20.0","3":"21479.52","4":"-19479.5244","5":"0.18207668","6":"14842.96","7":"2.290995e-01","8":"-1.43468366"},{"1":"20000","2":"3.0","3":"28549.20","4":"-8549.1974","5":"0.03647777","6":"15118.53","7":"6.370795e-03","8":"-0.58013434"},{"1":"45000","2":"5.0","3":"27717.47","4":"17282.5288","5":"0.02434290","6":"14955.62","7":"1.694457e-02","8":"1.16544768"},{"1":"20000","2":"12.0","3":"24806.43","4":"-4806.4293","5":"0.04332558","6":"15154.88","7":"2.426048e-03","8":"-0.32732153"},{"1":"50000","2":"7.0","3":"26885.74","4":"23114.2551","5":"0.02001180","6":"14784.60","7":"2.469691e-02","8":"1.55526206"},{"1":"50000","2":"8.0","3":"26469.88","4":"23530.1182","5":"0.02077267","6":"14770.04","7":"2.660797e-02","8":"1.58385874"},{"1":"39000","2":"11.0","3":"25222.29","4":"13777.7075","5":"0.03476094","6":"15033.29","7":"1.571136e-02","8":"0.93410052"},{"1":"20000","2":"11.0","3":"25222.29","4":"-5222.2925","5":"0.03476094","6":"15151.99","7":"2.257264e-03","8":"-0.35406080"},{"1":"12000","2":"6.0","3":"27301.61","4":"-15301.6081","5":"0.02120188","6":"15003.15","7":"1.149477e-02","8":"-1.03020727"},{"1":"15000","2":"2.0","3":"28965.06","4":"-13965.0606","5":"0.04547162","6":"15027.87","7":"2.159169e-02","8":"-0.95209985"},{"1":"27500","2":"5.0","3":"27717.47","4":"-217.4712","5":"0.02434290","6":"15171.78","7":"2.682993e-06","8":"-0.01466517"},{"1":"12000","2":"2.0","3":"28965.06","4":"-16965.0606","5":"0.04547162","6":"14958.90","7":"3.186484e-02","8":"-1.15663170"},{"1":"6000","2":"0.5","3":"29588.86","4":"-23588.8552","5":"0.06262041","6":"14749.72","7":"8.797046e-02","8":"-1.62286808"},{"1":"15000","2":"0.5","3":"29588.86","4":"-14588.8552","5":"0.06262041","6":"15011.77","7":"3.364849e-02","8":"-1.00368531"},{"1":"60000","2":"13.0","3":"24390.57","4":"35609.4338","5":"0.05384116","6":"14201.03","7":"1.691822e-01","8":"2.43846846"},{"1":"50000","2":"4.0","3":"28133.33","4":"21866.6657","5":"0.02943486","6":"14822.35","7":"3.314484e-02","8":"1.47844210"},{"1":"30000","2":"9.0","3":"26054.02","4":"3945.9813","5":"0.02348448","6":"15160.63","7":"8.506893e-04","8":"0.26598035"},{"1":"40000","2":"7.0","3":"26885.74","4":"13114.2551","5":"0.02001180","6":"15048.26","7":"7.950052e-03","8":"0.88240366"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ol start="3" type="1">
<li>The <code>glance()</code> function return section 4 part of the model or the model performance metrics as a data frame.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising model performance metrics</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.01612329","2":"-0.004374138","3":"15012.95","4":"0.7866007","5":"0.3795523","6":"1","7":"-550.7598","8":"1107.52","9":"1113.256","10":"10818649234","11":"48","12":"50"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="assessing-linear-model-fit" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="assessing-linear-model-fit"><span class="header-section-number">6</span> Assessing linear model fit</h2>
<p>Once we fit a model, we can predict values outside the dataset. A good model will be able to predict values more accurately, so how do we know how good a model is? To assess model fit, we mainly use three metrics and they are described below.</p>
<section id="r-squared-value" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="r-squared-value"><span class="header-section-number">6.1</span> R-squared value</h3>
<p><img src="images/lm_summary_1.png" class="img-fluid"></p>
<p>In section 4 of the model summary, we can see an R-squared value of 0.01612. The R-squared value explains how much of the variance seen in the response variable is explained by the explanatory variables. The value of R-squared is between 0 and 1. The value 0 corresponds to the worst possible fit and 1 corresponds to the best fit. Here we have a value close to 0, which means our model is poorly fit. The R-squared value is typically just the squared value of the correlation between the response and the explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the R-squared value</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01612329</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared is nothing but squared of correlation value</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">R_squared =</span> <span class="fu">cor</span>(Price, Age)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["R_squared"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.01612329"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="residual-standard-error-rse" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="residual-standard-error-rse"><span class="header-section-number">6.2</span> Residual standard error (RSE)</h3>
<p>Residual is the difference between the predicted and actual value in the model. The residual standard error estimated on average how much difference is there between the predicted and actual value in the model. A lower value suggests that the predicted value closely aligns with the values in the dataset suggesting a good fit.</p>
<p>In the previous model the residual standard error is;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the RSE value</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15012.95</code></pre>
</div>
</div>
<p>We got a value of 15012, this means that there is, on average a difference of 15012 dollars between the predicted and actual values in the dataset.</p>
<p>The residual standard error is calculated by taking the square root of the sum of the squared residuals divided by the number of degrees of freedom. The degrees of freedom are calculated as the difference between the total observations and the number of variables used in the model (we used Price and Age variables, so we used 2 variables in total).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the RSE value</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual_sq =</span> <span class="fu">residuals</span>(model_lm)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_residual_sq =</span> <span class="fu">sum</span>(residual_sq),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">degrees_of_freedom =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">2</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">rse =</span> <span class="fu">sqrt</span>(sum_residual_sq<span class="sc">/</span>degrees_of_freedom))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sum_residual_sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["degrees_of_freedom"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["rse"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"10818649234","2":"48","3":"15012.95"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="root-mean-square-error-rmse" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="root-mean-square-error-rmse"><span class="header-section-number">6.3</span> Root mean square error (RMSE)</h3>
<p>The root mean square error is another metric which is similar to that of the residual standard error value and functions the same way in quantifying how inaccurate model predictions are. It is typically not preferred but it is another metric that is sometimes used. The only difference in the calculation between RSE and RMSE is that instead of dividing by the degrees of freedom, RMSE is calculated by dividing the total number of observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the RMSE value</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual_sq =</span> <span class="fu">residuals</span>(model_lm)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_residual_sq =</span> <span class="fu">sum</span>(residual_sq),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_observations =</span> <span class="fu">n</span>(),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">rse =</span> <span class="fu">sqrt</span>(sum_residual_sq<span class="sc">/</span>total_observations))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sum_residual_sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["total_observations"],"name":[2],"type":["int"],"align":["right"]},{"label":["rse"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"10818649234","2":"50","3":"14709.62"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-linear-model-fit" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="visualizing-linear-model-fit"><span class="header-section-number">7</span> Visualizing linear model fit</h2>
<p>In addition, to assess model fit using different metrics, we can also visualize the model fit using different methods. These methods include <em>Residual vs.&nbsp;Fitted plot</em>, <em>Q-Q plot</em> and <em>Scale-location plot</em>. We will be using the <code>autoplot()</code> function in the <code>{ggfortify}</code> package in R to visualize all three of them. We will use the <code>which =</code> argument inside the <code>autoplot()</code> function to specify which plot to visualize. The argument takes in the following values;</p>
<ul>
<li><code>1</code> : Residual vs.&nbsp;Fitted plot</li>
<li><code>2</code> : Q-Q plot</li>
<li><code>3</code> : Scale-location plot</li>
</ul>
<p>Now let us see what each of these plots corresponds to.</p>
<section id="residual-vs.-fitted-plot" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="residual-vs.-fitted-plot"><span class="header-section-number">7.1</span> Residual vs.&nbsp;Fitted plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggfortify)) <span class="fu">install.packages</span>(<span class="st">'ggfortify'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residual vs. fitted plot</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Recall that the residual is the difference between the predicted value and the data value. In the plot shown above, the x-axis has the fitted or predicted values of the model and its corresponding residual value on the y-axis. If the predicted values closely resemble the actual data values, then the blue line will be very similar to the dotted horizontal line at y = 0. In our case, however, the model is a mess! as you can see the blue line very much deviates from the y = 0 line.</p>
</section>
<section id="q-q-plot" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="q-q-plot"><span class="header-section-number">7.2</span> Q-Q plot</h3>
<p>The Q-Q plot tells us whether the residuals are normally distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting Q-Q plot</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can see that the tail ends of the Q-Q plot deviate away from the straight line, suggesting that at lower and higher age values, the model does a poor fit to predict the price values.</p>
</section>
<section id="scale-location-plot" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="scale-location-plot"><span class="header-section-number">7.3</span> Scale-location plot</h3>
<p>The scale-location plot is plotted with the square root values of the standardized residual values on the y-axis and fitted or predicted values on the x-axis. The plot tells us whether, along the predicted value, the residuals get bigger or smaller.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting scale-location plot</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the plot shown above, starting from lower price values, the residuals decrease in size and for higher price values, the residuals increase in the size. Overall this suggests that for lower and higher age values in our dataset, the model struggles to output a good fit.</p>
<p>We can plot all three by inputting all the number arguments;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting all visualizations concerning the model fit </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="outliers-leverage-and-influence" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="outliers-leverage-and-influence"><span class="header-section-number">8</span> Outliers, leverage, and influence</h2>
<p>Outliers are data values which are either considerably large or small when compared to the rest of the data values. They rarely occur and can be due to pure chance or measurement errors. But they can have a strong influence on the linear relationship between two variables and can mess up our inferences while doing linear modelling. So there are two ways to assess the presence and effect of outliers in the dataset; they are called <em>leverage</em> and <em>influence</em>.</p>
<section id="leverage" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="leverage"><span class="header-section-number">8.1</span> Leverage</h3>
<p>Leverage value denotes extreme values in our dataset. Higher the leverage, the more extreme the data point is. We can find the leverage values from a model object using the <code>hatvalues()</code> function. Alternatively, using the <code>augment()</code> function from the <code>{broom}</code> package, we can extract the leverage value from the <code>.hat</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the leverage values using hatvalues()</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_lm)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the leverage values using augment()</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Price, Age, .hat) <span class="sc">%&gt;%</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.hat)) <span class="sc">%&gt;%</span> <span class="co"># Finding the extreme values</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Price"],"name":[1],"type":["int"],"align":["right"]},{"label":["Age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2000","2":"20","3":"0.18207668"},{"1":"1100","2":"19","3":"0.15790449"},{"1":"12000","2":"17","3":"0.11541294"},{"1":"4500","2":"14","3":"0.06630769"},{"1":"20000","2":"14","3":"0.06630769"},{"1":"45000","2":"14","3":"0.06630769"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Looks like we have three outliers in this dataset which have significantly large leverage values.</p>
</section>
<section id="influence" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="influence"><span class="header-section-number">8.2</span> Influence</h3>
<p>The influence of a data point measures how much of a difference will the model have if that value is excluded while building the model. It is represented by a metric called <em>Cook’s distance</em> where bigger values denoted higher influence and thus the presence of an outlier. We can use the <code>cooks.distance()</code> function to calculate the influence of data points in a model object. Alternatively, we can, like before, use the <code>augment()</code> function and extract the <code>.cooksd</code> column to get the Cook’s distance values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the influence values using cooks.distance()</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>cooks_distance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_lm)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the influence values using augment()</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Price, Age, .cooksd) <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.cooksd)) <span class="sc">%&gt;%</span> <span class="co"># Finding the extreme values</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Price"],"name":[1],"type":["int"],"align":["right"]},{"label":["Age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2000","2":"20.0","3":"0.22909945"},{"1":"1100","2":"19.0","3":"0.21362104"},{"1":"60000","2":"13.0","3":"0.16918220"},{"1":"6000","2":"0.5","3":"0.08797046"},{"1":"45000","2":"14.0","3":"0.07458970"},{"1":"4500","2":"14.0","3":"0.06399356"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="plotting-leverage-and-influence" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="plotting-leverage-and-influence"><span class="header-section-number">8.3</span> Plotting leverage and influence</h3>
<p>Like before, we can use the <code>autoplot()</code> function in the <code>{ggfortify}</code> package in R to visualize leverage and influence. The input values for <code>which =</code> corresponding leverage and influence are;</p>
<ul>
<li><code>4</code> : Cook’s distance</li>
<li><code>5</code> : Residuals vs.&nbsp;Leverage</li>
<li><code>6</code> : Cook’s distance vs.&nbsp;Leverage</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting all visualizations concerning leverage and influence</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the plots, it seems like we have three outliers which can significantly affect the model.</p>
</section>
</section>
<section id="logistic-regression" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">9</span> Logistic regression</h2>
<p>Linear models are best used for the continuous response variable. But sometimes we can have a binary response variable like; survival data: dead or alive, choice data: yes or no, survey data: disagree or agree. In these cases, linear models will not work and we should rely on logistic models, which model using a binomial distribution. The logistic model is built in R using the <code>glm()</code> function with <code>family =</code> argument set to <code>binomial</code>. This is shown below;</p>
<ul>
<li>Building a logistic model: <code>glm(response ~ predictor, data, family = "binomial")</code></li>
</ul>
<p>Let us look at the <code>CreditCard</code> dataset in the <code>{AER}</code> package in R. The dataset contains the credit history of a sample of applicants for a type of credit card. We will predict to see the success of the acceptance of the credit card application (<code>card</code>) using yearly income (<code>income</code>). Let us look at the dataset first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(AER)) <span class="fu">install.packages</span>(<span class="st">'AER'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the data</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CreditCard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["card"],"name":[1],"type":["fct"],"align":["left"]},{"label":["reports"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["income"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["share"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["expenditure"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["owner"],"name":[7],"type":["fct"],"align":["left"]},{"label":["selfemp"],"name":[8],"type":["fct"],"align":["left"]},{"label":["dependents"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["months"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["majorcards"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["active"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"yes","2":"0","3":"37.66667","4":"4.5200","5":"0.033269910","6":"124.983300","7":"yes","8":"no","9":"3","10":"54","11":"1","12":"12","_rn_":"1"},{"1":"yes","2":"0","3":"33.25000","4":"2.4200","5":"0.005216942","6":"9.854167","7":"no","8":"no","9":"3","10":"34","11":"1","12":"13","_rn_":"2"},{"1":"yes","2":"0","3":"33.66667","4":"4.5000","5":"0.004155556","6":"15.000000","7":"yes","8":"no","9":"4","10":"58","11":"1","12":"5","_rn_":"3"},{"1":"yes","2":"0","3":"30.50000","4":"2.5400","5":"0.065213780","6":"137.869200","7":"no","8":"no","9":"0","10":"25","11":"1","12":"7","_rn_":"4"},{"1":"yes","2":"0","3":"32.16667","4":"9.7867","5":"0.067050590","6":"546.503300","7":"yes","8":"no","9":"2","10":"64","11":"1","12":"5","_rn_":"5"},{"1":"yes","2":"0","3":"23.25000","4":"2.5000","5":"0.044438400","6":"91.996670","7":"no","8":"no","9":"0","10":"54","11":"1","12":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Here, the response variable <code>card</code> has only two values and thus is a binary response variable. Let us plot the data and see how the values are distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, card)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We get some interesting results, even at a low yearly income, we have a high number of successful credit applicants but at the same time, we also have many applicants getting rejected from acquiring a credit card. Very few people have their credit card requests rejected when they have a high yearly income. Overall, the plot seems to suggest that yearly income is not a good predictor for looking at the success of credit card applications. Let us see if that is the case by modelling the data using a logistic model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = card ~ income, family = "binomial", data = CreditCard)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2501   0.5301   0.7005   0.7502   0.8733  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.73452    0.15842   4.636 3.55e-06 ***
income       0.15582    0.04597   3.390 0.000699 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1404.6  on 1318  degrees of freedom
Residual deviance: 1391.6  on 1317  degrees of freedom
AIC: 1395.6

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Even though from the model it was not apparent that yearly income had an association with the success of a credit application, the model suggests that yearly income does significantly explain the variance seen in the success of the credit applications. We will come back to interpreting the model summary soon.</p>
<p>As seen earlier for linear models, we can also plot logistic models. We have to specify <code>method = "glm"</code> in the and then specify the family by inputting <code>method.args = list(family = binomial)</code>. Now to the plot, we have to change the y-axis variable to boolean values (0 or 1). We can either use the <code>recode()</code> function before plotting and modifying the dataset or straight away input <code>as.numeric()</code> to the y-axis variable and subtract 1 to rescale the values to boolean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the logistic model</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, <span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> F, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the y-axis, you can see values ranging from 0 to 1 and the blue trend line shifting towards 1 for high values of yearly income. This suggests that, as the yearly income increase, the probability of success in credit card application increases.</p>
<p>Now one question that might come to your mind (I had this question when I was learning regression) is why can’t we apply linear regression if it is just 0 and 1 values for the response variable. So let us plot both linear and logistic regression for the above data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the logistic model</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, <span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> F, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>HA! If we got a similar trend line as that of the logistic model, then why bother with a logistic model? Well, hold your horses! If we take a closer look at the trend line, we can see that the red line overshoots the y-axis value of 1. This means we have a probability value greater than 1 which is absurd. Perhaps the best way to see why linear models don’t work for binary response variables is by predicting values using them with values outside the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>((<span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">~</span> income, <span class="at">data =</span> CreditCard)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Generating random income values</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the values for linear and logistics</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the 'type = response' to calculate probabilities</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>predict_values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predict_lm =</span> <span class="fu">predict</span>(model_lm, explorartory_values),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">predict_log =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the predicted values as a line graph</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predict_values, <span class="fu">aes</span>(income)) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> predict_values, <span class="fu">aes</span>(<span class="at">y =</span> predict_lm, <span class="at">col =</span> <span class="st">"linear"</span>)) <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> predict_values, <span class="fu">aes</span>(<span class="at">y =</span> predict_log, <span class="at">col =</span> <span class="st">"logistic"</span>)) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="st">"Distribution"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can see that the predicted values using the linear model are going beyond 0 and 1 whereas the logistic model predicts values between 0 and 1. Also, notice the sigmoid curve or the S-shaped curve which is a characteristic of the logistic model. Thus for a binary response variable, logistic modelling is the best.</p>
</section>
<section id="making-predictions-using-a-logistic-model" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="making-predictions-using-a-logistic-model"><span class="header-section-number">10</span> Making predictions using a logistic model</h2>
<p>Like in the linear model, we use the <code>predict()</code> function to predict values using a logistics model. We can change the type of values we get from the <code>predict()</code> function using the <code>type =</code> argument. By default, the predict function outputs log odds ratio (which is <code>type = "link"</code>), another option is <code>type = "response"</code> which outputs probability values. Other ways for expressing predicted values from the model include ‘odds ratio’ and ’most likely outcomes.</p>
<section id="probability-values" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="probability-values"><span class="header-section-number">10.1</span> Probability values</h3>
<p>One of the easier ways of expressing the predicted values from a logistic model. Simply it just calculates the probability of the levels in the response variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the probability values</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing probability values</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["income"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["probability"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"-50","2":"0.000861106"},{"1":"-48","2":"0.001175608"},{"1":"-46","2":"0.001604792"},{"1":"-44","2":"0.002190316"},{"1":"-42","2":"0.002988834"},{"1":"-40","2":"0.004077276"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the probability values</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, probability)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Probability values"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of application being accepted"</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="most-likely-outcome" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="most-likely-outcome"><span class="header-section-number">10.2</span> Most likely outcome</h3>
<p>This is the easiest way to express logistic model predicted values. It rescales the probability values into stating whether an event happens or not. Simply put, it rounds the probability values to give either 0 or 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the most likely values</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">most_likely =</span> <span class="fu">round</span>(probability))</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing most likely values</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["income"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["probability"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["most_likely"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-50","2":"0.000861106","3":"0"},{"1":"-48","2":"0.001175608","3":"0"},{"1":"-46","2":"0.001604792","3":"0"},{"1":"-44","2":"0.002190316","3":"0"},{"1":"-42","2":"0.002988834","3":"0"},{"1":"-40","2":"0.004077276","3":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the most likely values</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, most_likely)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Most likely values"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of predicted applications being accepted"</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="odds-ratio" class="level3" data-number="10.3">
<h3 data-number="10.3" class="anchored" data-anchor-id="odds-ratio"><span class="header-section-number">10.3</span> Odds ratio</h3>
<p>The odds ratio is calculated by taking the probability of success divided by the probability of losing. In simple terms, it tells the odds of one event happening compared to the other.</p>
<p><span class="math display">Odds\,ratio = \frac{p(success)}{1-p(success)} = \frac{p(success)}{p(fail)}</span></p>
<p>We can visualize this from the predicted values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the odds ratio values</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">odds_ratio =</span> probability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> probability))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing odds ratio values</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["income"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["probability"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-50","2":"0.000861106","3":"0.0008618481"},{"1":"-48","2":"0.001175608","3":"0.0011769920"},{"1":"-46","2":"0.001604792","3":"0.0016073714"},{"1":"-44","2":"0.002190316","3":"0.0021951236"},{"1":"-42","2":"0.002988834","3":"0.0029977936"},{"1":"-40","2":"0.004077276","3":"0.0040939683"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the odds ratio values</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, odds_ratio)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Odds ratio"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Odds ratio"</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot has a horizontal line plotted with y = 0. The points on this line correspond to equal odds of being rejected and accepted for a credit card application (equal odds of winning and losing). The y values for example 1000 correspond to 1000 successes for every one failure in a credit card application. The plot suggests that after the 18,000 dollars yearly income mark, the odds of success to failure rise exponentially.</p>
</section>
<section id="log-odds-ratio" class="level3" data-number="10.4">
<h3 data-number="10.4" class="anchored" data-anchor-id="log-odds-ratio"><span class="header-section-number">10.4</span> Log odds ratio</h3>
<p>The log odds ratio is the log-transformed value of the odds ratio. We will see how this value is superior to all the other values when we plot the values. Since we are transforming the y-axis values to log, we convert the scale of the y-axis to log using the <code>scale_y_log10()</code> function. By default, the <code>predict()</code> function outputs log odds ratio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the log odds ratio values</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">odds_ratio =</span> probability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> probability),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_odds_ratio =</span> <span class="fu">log</span>(odds_ratio),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_odds_ratio_1 =</span> <span class="fu">predict</span>(model_log, explorartory_values))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing log odds ratio values</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["income"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["probability"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["log_odds_ratio"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["log_odds_ratio_1"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"-50","2":"0.000861106","3":"0.0008618481","4":"-7.056431","5":"-7.056431"},{"1":"-48","2":"0.001175608","3":"0.0011769920","4":"-6.744793","5":"-6.744793"},{"1":"-46","2":"0.001604792","3":"0.0016073714","4":"-6.433155","5":"-6.433155"},{"1":"-44","2":"0.002190316","3":"0.0021951236","4":"-6.121517","5":"-6.121517"},{"1":"-42","2":"0.002988834","3":"0.0029977936","4":"-5.809879","5":"-5.809879"},{"1":"-40","2":"0.004077276","3":"0.0040939683","4":"-5.498241","5":"-5.498241"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the log odds ratio values</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, odds_ratio)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Log Odds ratio"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Odds ratio"</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Log transforming the odds ratio values resulted in a linear trend line which is easier to understand the overall relationship. We can see that as yearly income increases, the probability of success in credit card application will also rise.</p>
<p>Given below is the summary of the predicted value types and their usage concerning the audience in question. Some values like most likely outcomes might be best in explaining the trends in the data for non-experts or common people, whereas log odds might be best for experts.</p>
<table class="table">
<caption>Different scales of predicted values from a logistic model</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Scale</th>
<th>Easier to explain values?</th>
<th>Easier to explain changes in the response variable?</th>
<th>Is it precise?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Probability</td>
<td>Yes</td>
<td>Not easy for x values in the middle</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Most likely outcomes</td>
<td>Easiest out of all</td>
<td>Quickly compare high and low x values</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Odds ratio</td>
<td>Kind of easy to explain.<br>Odds of one event against another</td>
<td>Not really</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Log odds ratio</td>
<td>Log transformed values are harder to explain</td>
<td>Linear relation after log transformation<br>makes it easy to interpret changes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="understanding-the-summary-of-a-logistic-model" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="understanding-the-summary-of-a-logistic-model"><span class="header-section-number">11</span> Understanding the summary of a logistic model</h2>
<p>Now let us look at the summary of the logistic model we built earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/log_summary_1.png" class="img-fluid"></p>
<ol type="1">
<li><p>Section 1 is the model formula we used to build the model.</p></li>
<li><p>Section 2 is the quantile values of the residuals in the model, which is to check if the residuals are normally distributed.</p></li>
<li><p>Section 3 outlines the model coefficients which are in log odds values which we discussed in detail above.</p></li>
<li><p>Section 4. I don’t know what these values are, so once I learn I will update this text.</p></li>
<li><p>Section 5. I don’t know what these values are, so once I learn I will update this text.</p></li>
</ol>
</section>
<section id="assessing-logistic-model-fit" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="assessing-logistic-model-fit"><span class="header-section-number">12</span> Assessing logistic model fit</h2>
<p>To assess the performance of a logistic model we have several different metrics we can use that are different from the linear model metrics. Let us look at each of them.</p>
<section id="confusion-matrix" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="confusion-matrix"><span class="header-section-number">12.1</span> Confusion matrix</h3>
<p>The confusion matrix is a 2 by 2 matrix showcasing the number of correct predictions and no of wrong predictions.</p>
<table class="table">
<caption>The framework of a confusion matrix</caption>
<thead>
<tr class="header">
<th>Scale</th>
<th>Actually false</th>
<th>Actually true</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Predicted false</td>
<td>True negative</td>
<td>False negative</td>
</tr>
<tr class="even">
<td>Predicted true</td>
<td>False positive</td>
<td>True positive</td>
</tr>
</tbody>
</table>
<p>Let us make a confusion matrix of a logistic model where credit card success (<code>card</code>) is predicted by the number of major derogatory reports against the applicant (<code>reports</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>confusion_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                actual_values
predicted_values    0    1
               0  104   18
               1  192 1005</code></pre>
</div>
</div>
<p>We have 1109 (104 + 1005) correct predictions, 18 false negatives and 192 false positives. We can plot the confusion matrix with the help of <code>{yardstick}</code> and <code>{ggfortify}</code> packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(yardstick)) <span class="fu">install.packages</span>(<span class="st">'yardstick'</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the confusion matrix</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(conf_matrix) <span class="sc">+</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mosaic plot of confusion matrix"</span>,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual value"</span>,</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted value"</span>) <span class="sc">+</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_reg_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let us see how to interpret this plot. In the x-axis, you can see the actual values, 0 corresponds to failure in getting the credit card application accepted and 1 corresponds to the success of the same. The width of the bars corresponds to the proportion of the values of 0 and 1 in the dataset. There are more success values than failure values. Now, for the corresponding actual value, we have the bar split into respective predicted values. For actual failure values, we have a lot of predicted values falsely marking it as success. On the other hand, for the actual success value, most of the predicted values were correct. Thus the first bar under 0 tells us about the false positive cases and the second bar under 1 tells us about the false negative cases. We can see that our model has more false positive cases than false positive cases which is what we saw in the confusion matrix.</p>
</section>
<section id="accuracy" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="accuracy"><span class="header-section-number">12.2</span> Accuracy</h3>
<p>Accuracy is simply the proportion of correct predictions compared to all predictions.</p>
<p><span class="math display">Accuracy = \frac{true\,positives + true\,negatives}{total\,predictions}</span></p>
<p>We can find the accuracy from the summary of the confusion matrix we made using the <code>summary()</code> and <code>slice()</code> functions. The <code>event_level = "second"</code> is to denote the second column of the confusion matrix as the success value which is 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding accuracy of the model</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"accuracy","2":"binary","3":"0.8407885"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We got an accuracy value of 84% for the model we built.</p>
</section>
<section id="sensitivity" class="level3" data-number="12.3">
<h3 data-number="12.3" class="anchored" data-anchor-id="sensitivity"><span class="header-section-number">12.3</span> Sensitivity</h3>
<p>Sensitivity tells us the proportion of true positives. Higher values suggest that there are fewer false negatives.</p>
<p><span class="math display">Sensitivity = \frac{true\,positives}{false\,negatives + true\,positives}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding sensitivity of the model</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"sens","2":"binary","3":"0.9824047"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We have around very 2% false negatives (100 - 98).</p>
</section>
<section id="specificity" class="level3" data-number="12.4">
<h3 data-number="12.4" class="anchored" data-anchor-id="specificity"><span class="header-section-number">12.4</span> Specificity</h3>
<p>Sensitivity tells us the proportion of true negatives. Higher values suggest that there are fewer false positives.</p>
<p><span class="math display">Specificity = \frac{true\,negatives}{false\,positives + true\,negatives}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding specificity of the model</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"spec","2":"binary","3":"0.3513514"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We have around 64% false positives (100 - 35).</p>
</section>
</section>
<section id="conclusion" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">13</span> Conclusion</h2>
<p>Hurray! We completed the basics of regression using R. This tutorial will lay the foundations for learning statistical modelling which I have covered in the tutorial section. Let us recap what we studied in this tutorial;</p>
<ol type="1">
<li><p>What is linear regression / linear model</p></li>
<li><p>How to build a linear model and use it to predict</p></li>
<li><p>Understanding the linear model summary output</p></li>
<li><p>How to view model outputs as data frames using the <code>{broom}</code> package</p></li>
<li><p>Assessing linear model performance using; R-squared, Residual standard error and Root mean square error</p></li>
<li><p>Visualizing model fit using; Residual vs.&nbsp;Fitted plot, Q-Q plot and Scale-location plot</p></li>
<li><p>Analysing outliers using; Leverage (hat values) and Influence (cook’s distance)</p></li>
<li><p>What is logistic regression / logistic model</p></li>
<li><p>How to build a logistic model</p></li>
<li><p>Different types of predictions using the logistic model: Probability values, Most like outcomes, Odds ratio and Log odds ratio</p></li>
<li><p>Understanding the logistic model summary output</p></li>
<li><p>Assessing logistic model performance using; Confusion matrix, Accuracy, Sensitivity and Specificity</p></li>
</ol>
<!-- Do not forget to put flag counter -->
<p><a hidden="" href="https://info.flagcounter.com/ynrK"><img src="https://s11.flagcounter.com/count2/ynrK/bg_000000/txt_FFFFFF/border_F0F0F0/columns_5/maxflags_25/viewers_0/labels_1/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{johnson2022,
  author = {Johnson, Jewel},
  title = {Introduction to {Regression} in {R}},
  date = {2022-09-02},
  url = {https://sciquest.netlify.app//tutorials/stat_basic/intro_reg.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-johnson2022" class="csl-entry quarto-appendix-citeas" role="listitem">
Johnson, Jewel. 2022. <span>“Introduction to Regression in R.”</span>
September 2, 2022. <a href="https://sciquest.netlify.app//tutorials/stat_basic/intro_reg.html">https://sciquest.netlify.app//tutorials/stat_basic/intro_reg.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="jeweljohnsonj/SciQuest" data-repo-id="R_kgDOHW124A" data-category="General" data-category-id="DIC_kwDOHW124M4CPNVL" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Introduction to Regression in R"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Learn the basics of regression in R"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "09/02/2022"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">    css:</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">      - https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> images/intro_reg.png</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [regression]</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co">   - social-share</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="an">share:</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">  permalink: "https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html"</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co">  description: "Introduction to Regression in R"</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co">  twitter: true</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co">  facebook: true</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co">  reddit: true</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co">  stumble: true</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co">  tumblr: true</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co">  linkedin: true</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="co">  email: true</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## TL;DR</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>In this article you will learn;</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>What is linear regression / linear model</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>How to build a linear model and use it to predict</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="ss">3.    </span>Understanding the linear model summary output</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="ss">4.    </span>How to view model outputs as data frames using the <span class="in">`{broom}`</span> package</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="ss">5.    </span>Assessing linear model performance using; R-squared, Residual standard error and Root mean square error</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="ss">6.    </span>Visualizing model fit using; Residual vs. Fitted plot, Q-Q plot and Scale-location plot</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="ss">7.    </span>Analysing outliers using; Leverage (hat values) and Influence (cook's distance)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a><span class="ss">8.    </span>What is logistic regression / logistic model</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="ss">9.    </span>How to build a logistic model</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="ss">10.   </span>Different types of predictions using the logistic model: Probability values, Most like outcomes, Odds ratio and Log odds ratio</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="ss">11.   </span>Understanding the logistic model summary output</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a><span class="ss">12.   </span>Assessing logistic model performance using; Confusion matrix, Accuracy, Sensitivity and Specificity</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>In this tutorial, we will learn the basics of linear regression and logistic regression using R. We will learn how interpret the model summaries of both of them, how to predict values using models, how to assess and visualize model performance and so on.</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear regression</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>Regression models are a part of statistical models which are used to find relationships between variables in a dataset. Linear regression or linear models are the simplest of the models which describe a linear relationship between two variables. Throughout this tutorial (and also in other tutorials) I might use regression and model interchangeably, please don't get confused and just have it in your mind that they generally mean the same.</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>We will use the <span class="in">`HorsePrices`</span> dataset from the <span class="in">`{Stat2Data}`</span> package in R. The dataset contains the price and related characteristics of horses listed for sale on the internet. Using the dataset, we will see how the price of a horse (<span class="in">`Price`</span>) changes according to its age (<span class="in">`Age`</span>) using a linear model. We will plot this association using the <span class="in">`geom_smooth()`</span> function in the <span class="in">`{ggplot2}`</span> package in R. But first let us visualize the dataset.</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(Stat2Data)) <span class="fu">install.packages</span>(<span class="st">'Stat2Data'</span>)</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>Now let us fit a model to the graph using the <span class="in">`geom_smooth()`</span> function. To fit a linear model, we will use the <span class="in">`method = "lm"`</span> argument. By default, the linear trend line comes with confidence intervals, we can disable this by specifying <span class="in">`se = F`</span>.</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting a linear model</span></span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se  =</span> F) <span class="sc">+</span></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>From the linear trend line, we can see that there is some evidence suggesting that the price of the horse decreases as they age.</span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>In the above linear regression plot, the relationship between the price of the horse and the age of the horse is described as a straight line which is the feature of linear regression. Thus, this trend line can be described by the equation of the straight line;</span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>$$y=mx+c$$</span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>Here $m$ is the slope and $c$ is the y-intercept.</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a>Now let's try to get the slope and y-intercept values for the model we just plotted. We will use the <span class="in">`lm()`</span> function to model the regression of price and age of the horses. The syntax for the <span class="in">`lm()`</span> function is as follows;</span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`lm(dependent variable ~ independent variable, dataset_name)`</span></span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a>Here, we want to see how the price of the horse, which is the dependent variable, depends on the age of the horse, which is the independent variable. As mentioned before, linear regression is a type of statistical model. So in other words, we can also say that we are building a linear model to predict the price of the horse using the age of the horse. </span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a>We get two values, an 'intercept' value and a value under the column 'Age'. </span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>Here the slope of the line is denoted under the 'Age' column and is -415.9</span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>The y-intercept is given under the column intercept and is 29796.8.</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>Now, what do these values mean according to our model? Recall that the slope is the rate of change of y for x. Therefore, the value of -415.9 means that, as the horse ages one year, the price of the horse decreases by 415.9 dollars. Similarly, the y-intercept value is got when the x value is zero. So the intercept value of 29796.8 means that if the horse has an age of 0 years, or a newborn horse has an average price of 29796.8 dollars. The y-intercept and the slopes got from the model output are called the coefficients.</span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a>We can also predict the values of the response variable using a categorical explanatory variable. In the earlier case, the age of the horse was a numerical value, and we calculated the slope of it. Then what values do we get for a categorical explanatory variable?</span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a>To test this we will use the <span class="in">`Hawks`</span> dataset from the <span class="in">`{Stat2Data}`</span> package in R. The dataset contains measurements of three hawk species. We will see if body weight (<span class="in">`Weight`</span>) is different between the three hawk species (<span class="in">`Species`</span>). The three different hawk species in this dataset are; CH=Cooper’s, RT=Red-tailed, and SS=Sharp-Shinned.</span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Species, <span class="at">data =</span> Hawks)</span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>We got the coefficient values where we have an intercept value and the values for two of the hawk species (RT and SS), so what happened to the third species (CH)? And what do the values for each species mean?</span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a>The intercept value shows the mean body weight for the third species (CH) and the rest of the values by their magnitude and sign tell us how greater or less their average body weight is. For example, the average body weight of RT is 420.5 + 673.9 = 1094.4g. We can change the model formula syntax by adding <span class="in">`-1`</span>, to calculate individual averages for each level in our categorical explanatory variable.</span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Species <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Hawks)</span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the model results</span></span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_lm)</span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-175"><a href="#cb53-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-176"><a href="#cb53-176" aria-hidden="true" tabindex="-1"></a>Thus we essentially get the back the average body masses of all the hawk species in our data. We can cross check this by checking the means individually as shown below.</span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Hawks"</span>)</span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the mean</span></span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a>Hawks <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species, Weight) <span class="sc">%&gt;%</span></span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(Weight, <span class="at">na.rm =</span> T))</span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a><span class="fu">## Making predicition using a linear model</span></span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>One cool use of models is that we can use them to predict values for which data is not available. Let us go back to the first model we created where we have the price of horses predicted by their age. Let us look at the plot again.</span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(Stat2Data)) <span class="fu">install.packages</span>(<span class="st">'Stat2Data'</span>)</span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-203"><a href="#cb53-203" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-204"><a href="#cb53-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-205"><a href="#cb53-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting a linear model</span></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se  =</span> F) <span class="sc">+</span></span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does the price of the horse decrease as they age?"</span>,</span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price (dollars)"</span>) <span class="sc">+</span></span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-213"><a href="#cb53-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-214"><a href="#cb53-214" aria-hidden="true" tabindex="-1"></a>We have age values from 1 year to 20 years. What if we want to know what the price of the course would be for a 30-year-old horse given the trend seen without collected data? We can know this price with the use of the model we created. Using the <span class="in">`predict()`</span> function, we can input our model and the value for which we want the prediction.</span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-218"><a href="#cb53-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-220"><a href="#cb53-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-221"><a href="#cb53-221" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-222"><a href="#cb53-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-223"><a href="#cb53-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a>age_30 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age=</span><span class="fu">c</span>(<span class="dv">30</span>))</span>
<span id="cb53-227"><a href="#cb53-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-228"><a href="#cb53-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting price for a 30 years old horse</span></span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_lm, <span class="at">newdata =</span> age_30)</span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-232"><a href="#cb53-232" aria-hidden="true" tabindex="-1"></a>Our model predicts that the price of a 30-year-old horse would be 17320.89 dollars. Therefore, even though we did not have data for a 30-year-old horse, with help of our model, we were able to extrapolate to find the price for the 30-year-old horse.</span>
<span id="cb53-233"><a href="#cb53-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding the summary of a linear model</span></span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`summary()`</span> function to get the results of the linear model. Let us look at what each section in summary means;</span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-250"><a href="#cb53-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb53-251"><a href="#cb53-251" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lm)</span>
<span id="cb53-252"><a href="#cb53-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/lm_summary_1.png)</span></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-256"><a href="#cb53-256" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>In section 1, we have the model formula used for modelling</span>
<span id="cb53-257"><a href="#cb53-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>In section 2, we have the 1st quartile, median and the 3rd quartile of the residuals. The residual is the distance or difference between the predicted value and the actual value in the dataset. One of the important requirements for a linear model to be applied to a dataset is that the residuals should be normally distributed. We can check if the residuals are normally distributed by looking at this section. For normally distributed residuals, the median should be close to zero and the 1st and 3rd quartiles should have similar absolute values.</span>
<span id="cb53-259"><a href="#cb53-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-260"><a href="#cb53-260" aria-hidden="true" tabindex="-1"></a><span class="ss">3.    </span>In section 3, we have the y intercept value and the slope for the Age variable. We also have the standard error value and the t-statistics coupled with a corresponding p-value. The level of significance is noted by the number of asterisks.</span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-262"><a href="#cb53-262" aria-hidden="true" tabindex="-1"></a><span class="ss">4.    </span>In section 4, we can evaluate the model performance. There are mainly two metrics that assess the model fit; the *residual standard error* and the *R-squared value*. We will see more about these values later.</span>
<span id="cb53-263"><a href="#cb53-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting the model output</span></span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a>Using various functions in the <span class="in">`{broom}`</span> package in R, we can extract or view different model outputs.</span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>We can use the <span class="in">`tidy()`</span> function to view or save the coefficients of the model as a data frame which is easier to manipulate using different functions in the <span class="in">`{dplyr}`</span> package.</span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-272"><a href="#cb53-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-273"><a href="#cb53-273" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-276"><a href="#cb53-276" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-277"><a href="#cb53-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-279"><a href="#cb53-279" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-280"><a href="#cb53-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-281"><a href="#cb53-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising coefficients and other metrics as a data frame</span></span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_lm)</span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-285"><a href="#cb53-285" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>We can use the <span class="in">`augment()`</span> function to return the dataset values with their corresponding fitted value and various other values. The <span class="in">`.fitted`</span> column contains the fitted values and the <span class="in">`.resid`</span> column contains the residuals.</span>
<span id="cb53-286"><a href="#cb53-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-294"><a href="#cb53-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-295"><a href="#cb53-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising dataset and model output values</span></span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(model_lm)</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-301"><a href="#cb53-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-302"><a href="#cb53-302" aria-hidden="true" tabindex="-1"></a><span class="ss">3.    </span>The <span class="in">`glance()`</span> function return section 4 part of the model or the model performance metrics as a data frame.</span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-307"><a href="#cb53-307" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-308"><a href="#cb53-308" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising model performance metrics</span></span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model_lm)</span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assessing linear model fit</span></span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a>Once we fit a model, we can predict values outside the dataset. A good model will be able to predict values more accurately, so how do we know how good a model is? To assess model fit, we mainly use three metrics and they are described below.</span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### R-squared value</span></span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/lm_summary_1.png)</span></span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a>In section 4 of the model summary, we can see an R-squared value of 0.01612. The R-squared value explains how much of the variance seen in the response variable is explained by the explanatory variables. The value of R-squared is between 0 and 1. The value 0 corresponds to the worst possible fit and 1 corresponds to the best fit. Here we have a value close to 0, which means our model is poorly fit. The R-squared value is typically just the squared value of the correlation between the response and the explanatory variable.</span>
<span id="cb53-328"><a href="#cb53-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-331"><a href="#cb53-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-336"><a href="#cb53-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-337"><a href="#cb53-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the R-squared value</span></span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r.squared)</span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared is nothing but squared of correlation value</span></span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">R_squared =</span> <span class="fu">cor</span>(Price, Age)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-346"><a href="#cb53-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-347"><a href="#cb53-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual standard error (RSE)</span></span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a>Residual is the difference between the predicted and actual value in the model. The residual standard error estimated on average how much difference is there between the predicted and actual value in the model. A lower value suggests that the predicted value closely aligns with the values in the dataset suggesting a good fit.</span>
<span id="cb53-351"><a href="#cb53-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-352"><a href="#cb53-352" aria-hidden="true" tabindex="-1"></a>In the previous model the residual standard error is;</span>
<span id="cb53-353"><a href="#cb53-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-363"><a href="#cb53-363" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-364"><a href="#cb53-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-365"><a href="#cb53-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the RSE value</span></span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a>We got a value of 15012, this means that there is, on average a difference of 15012 dollars between the predicted and actual values in the dataset.</span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-372"><a href="#cb53-372" aria-hidden="true" tabindex="-1"></a>The residual standard error is calculated by taking the square root of the sum of the squared residuals divided by the number of degrees of freedom. The degrees of freedom are calculated as the difference between the total observations and the number of variables used in the model (we used Price and Age variables, so we used 2 variables in total).</span>
<span id="cb53-373"><a href="#cb53-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-377"><a href="#cb53-377" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-378"><a href="#cb53-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-380"><a href="#cb53-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-381"><a href="#cb53-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the RSE value</span></span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span></span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual_sq =</span> <span class="fu">residuals</span>(model_lm)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_residual_sq =</span> <span class="fu">sum</span>(residual_sq),</span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a>            <span class="at">degrees_of_freedom =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">2</span>,</span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a>            <span class="at">rse =</span> <span class="fu">sqrt</span>(sum_residual_sq<span class="sc">/</span>degrees_of_freedom))</span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Root mean square error (RMSE)</span></span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a>The root mean square error is another metric which is similar to that of the residual standard error value and functions the same way in quantifying how inaccurate model predictions are. It is typically not preferred but it is another metric that is sometimes used. The only difference in the calculation between RSE and RMSE is that instead of dividing by the degrees of freedom, RMSE is calculated by dividing the total number of observations.</span>
<span id="cb53-395"><a href="#cb53-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the RMSE value</span></span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a>HorsePrices <span class="sc">%&gt;%</span></span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual_sq =</span> <span class="fu">residuals</span>(model_lm)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_residual_sq =</span> <span class="fu">sum</span>(residual_sq),</span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_observations =</span> <span class="fu">n</span>(),</span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a>            <span class="at">rse =</span> <span class="fu">sqrt</span>(sum_residual_sq<span class="sc">/</span>total_observations))</span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-413"><a href="#cb53-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-414"><a href="#cb53-414" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizing linear model fit</span></span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-416"><a href="#cb53-416" aria-hidden="true" tabindex="-1"></a>In addition, to assess model fit using different metrics, we can also visualize the model fit using different methods. These methods include *Residual vs. Fitted plot*, *Q-Q plot* and *Scale-location plot*. We will be using the <span class="in">`autoplot()`</span> function in the <span class="in">`{ggfortify}`</span> package in R to visualize all three of them. We will use the <span class="in">`which = `</span> argument inside the <span class="in">`autoplot()`</span> function to specify which plot to visualize. The argument takes in the following values;</span>
<span id="cb53-417"><a href="#cb53-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`1`</span> : Residual vs. Fitted plot</span>
<span id="cb53-419"><a href="#cb53-419" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`2`</span> : Q-Q plot</span>
<span id="cb53-420"><a href="#cb53-420" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`3`</span> : Scale-location plot</span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a>Now let us see what each of these plots corresponds to.</span>
<span id="cb53-423"><a href="#cb53-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-424"><a href="#cb53-424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residual vs. Fitted plot</span></span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggfortify)) <span class="fu">install.packages</span>(<span class="st">'ggfortify'</span>)</span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-433"><a href="#cb53-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-434"><a href="#cb53-434" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-436"><a href="#cb53-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-437"><a href="#cb53-437" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting residual vs. fitted plot</span></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a>Recall that the residual is the difference between the predicted value and the data value. In the plot shown above, the x-axis has the fitted or predicted values of the model and its corresponding residual value on the y-axis. If the predicted values closely resemble the actual data values, then the blue line will be very similar to the dotted horizontal line at y = 0. In our case, however, the model is a mess! as you can see the blue line very much deviates from the y = 0 line.</span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Q-Q plot</span></span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a>The Q-Q plot tells us whether the residuals are normally distributed. </span>
<span id="cb53-448"><a href="#cb53-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-455"><a href="#cb53-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-456"><a href="#cb53-456" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-458"><a href="#cb53-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-459"><a href="#cb53-459" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting Q-Q plot</span></span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a>You can see that the tail ends of the Q-Q plot deviate away from the straight line, suggesting that at lower and higher age values, the model does a poor fit to predict the price values.</span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scale-location plot</span></span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a>The scale-location plot is plotted with the square root values of the standardized residual values on the y-axis and fitted or predicted values on the x-axis. The plot tells us whether, along the predicted value, the residuals get bigger or smaller.</span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-473"><a href="#cb53-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-477"><a href="#cb53-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-478"><a href="#cb53-478" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting scale-location plot</span></span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-487"><a href="#cb53-487" aria-hidden="true" tabindex="-1"></a>In the plot shown above, starting from lower price values, the residuals decrease in size and for higher price values, the residuals increase in the size. Overall this suggests that for lower and higher age values in our dataset, the model struggles to output a good fit.</span>
<span id="cb53-488"><a href="#cb53-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a>We can plot all three by inputting all the number arguments;</span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-500"><a href="#cb53-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-501"><a href="#cb53-501" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting all visualizations concerning the model fit </span></span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outliers, leverage, and influence</span></span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a>Outliers are data values which are either considerably large or small when compared to the rest of the data values. They rarely occur and can be due to pure chance or measurement errors. But they can have a strong influence on the linear relationship between two variables and can mess up our inferences while doing linear modelling. So there are two ways to assess the presence and effect of outliers in the dataset; they are called *leverage* and *influence*.</span>
<span id="cb53-510"><a href="#cb53-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-511"><a href="#cb53-511" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leverage</span></span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a>Leverage value denotes extreme values in our dataset. Higher the leverage, the more extreme the data point is. We can find the leverage values from a model object using the <span class="in">`hatvalues()`</span> function. Alternatively, using the <span class="in">`augment()`</span> function from the <span class="in">`{broom}`</span> package, we can extract the leverage value from the <span class="in">`.hat`</span> column.</span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-524"><a href="#cb53-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-525"><a href="#cb53-525" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-526"><a href="#cb53-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the leverage values using hatvalues()</span></span>
<span id="cb53-528"><a href="#cb53-528" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_lm)</span>
<span id="cb53-529"><a href="#cb53-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-530"><a href="#cb53-530" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the leverage values using augment()</span></span>
<span id="cb53-531"><a href="#cb53-531" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-532"><a href="#cb53-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Price, Age, .hat) <span class="sc">%&gt;%</span></span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.hat)) <span class="sc">%&gt;%</span> <span class="co"># Finding the extreme values</span></span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a>Looks like we have three outliers in this dataset which have significantly large leverage values. </span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-539"><a href="#cb53-539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Influence</span></span>
<span id="cb53-540"><a href="#cb53-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a>The influence of a data point measures how much of a difference will the model have if that value is excluded while building the model. It is represented by a metric called *Cook's distance* where bigger values denoted higher influence and thus the presence of an outlier. We can use the <span class="in">`cooks.distance()`</span> function to calculate the influence of data points in a model object. Alternatively, we can, like before, use the <span class="in">`augment()`</span> function and extract the <span class="in">`.cooksd`</span> column to get the Cook's distance values.</span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-545"><a href="#cb53-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-546"><a href="#cb53-546" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the influence values using cooks.distance()</span></span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a>cooks_distance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_lm)</span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the influence values using augment()</span></span>
<span id="cb53-559"><a href="#cb53-559" aria-hidden="true" tabindex="-1"></a>model_lm <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-560"><a href="#cb53-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Price, Age, .cooksd) <span class="sc">%&gt;%</span></span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.cooksd)) <span class="sc">%&gt;%</span> <span class="co"># Finding the extreme values</span></span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb53-563"><a href="#cb53-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-564"><a href="#cb53-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting leverage and influence</span></span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-567"><a href="#cb53-567" aria-hidden="true" tabindex="-1"></a>Like before, we can use the <span class="in">`autoplot()`</span> function in the <span class="in">`{ggfortify}`</span> package in R to visualize leverage and influence. The input values for <span class="in">`which = `</span> corresponding leverage and influence are;</span>
<span id="cb53-568"><a href="#cb53-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-569"><a href="#cb53-569" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`4`</span> : Cook's distance</span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`5`</span> : Residuals vs. Leverage</span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`6`</span> : Cook's distance vs. Leverage</span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HorsePrices"</span>)</span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-582"><a href="#cb53-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a linear model </span></span>
<span id="cb53-583"><a href="#cb53-583" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Price <span class="sc">~</span> Age, <span class="at">data =</span> HorsePrices)</span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting all visualizations concerning leverage and influence</span></span>
<span id="cb53-586"><a href="#cb53-586" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_lm, <span class="at">which =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb53-587"><a href="#cb53-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a>From the plots, it seems like we have three outliers which can significantly affect the model.</span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression</span></span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a>Linear models are best used for the continuous response variable. But sometimes we can have a binary response variable like; survival data: dead or alive, choice data: yes or no, survey data: disagree or agree. In these cases, linear models will not work and we should rely on logistic models, which model using a binomial distribution. The logistic model is built in R using the <span class="in">`glm()`</span> function with <span class="in">`family = `</span> argument set to <span class="in">`binomial`</span>. This is shown below;</span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Building a logistic model: <span class="in">`glm(response ~ predictor, data, family = "binomial")`</span></span>
<span id="cb53-596"><a href="#cb53-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-597"><a href="#cb53-597" aria-hidden="true" tabindex="-1"></a>Let us look at the <span class="in">`CreditCard`</span> dataset in the <span class="in">`{AER}`</span> package in R. The dataset contains the credit history of a sample of applicants for a type of credit card. We will predict to see the success of the acceptance of the credit card application (<span class="in">`card`</span>) using yearly income (<span class="in">`income`</span>). Let us look at the dataset first.</span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(AER)) <span class="fu">install.packages</span>(<span class="st">'AER'</span>)</span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-605"><a href="#cb53-605" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-606"><a href="#cb53-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the data</span></span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CreditCard)</span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a>Here, the response variable <span class="in">`card`</span> has only two values and thus is a binary response variable. Let us plot the data and see how the values are distributed.</span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-618"><a href="#cb53-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-619"><a href="#cb53-619" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-621"><a href="#cb53-621" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb53-622"><a href="#cb53-622" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, card)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a>We get some interesting results, even at a low yearly income, we have a high number of successful credit applicants but at the same time, we also have many applicants getting rejected from acquiring a credit card. Very few people have their credit card requests rejected when they have a high yearly income. Overall, the plot seems to suggest that yearly income is not a good predictor for looking at the success of credit card applications. Let us see if that is the case by modelling the data using a logistic model.</span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-634"><a href="#cb53-634" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-635"><a href="#cb53-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-637"><a href="#cb53-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-638"><a href="#cb53-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb53-642"><a href="#cb53-642" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_log)</span>
<span id="cb53-643"><a href="#cb53-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a>Even though from the model it was not apparent that yearly income had an association with the success of a credit application, the model suggests that yearly income does significantly explain the variance seen in the success of the credit applications. We will come back to interpreting the model summary soon.</span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a>As seen earlier for linear models, we can also plot logistic models. We have to specify <span class="in">`method = "glm"`</span> in the and then specify the family by inputting <span class="in">`method.args = list(family = binomial)`</span>. Now to the plot, we have to change the y-axis variable to boolean values (0 or 1). We can either use the <span class="in">`recode()`</span> function before plotting and modifying the dataset or straight away input <span class="in">`as.numeric()`</span> to the y-axis variable and subtract 1 to rescale the values to boolean.</span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-655"><a href="#cb53-655" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-656"><a href="#cb53-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the logistic model</span></span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, <span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> F, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial)) <span class="sc">+</span></span>
<span id="cb53-660"><a href="#cb53-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-661"><a href="#cb53-661" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a>In the y-axis, you can see values ranging from 0 to 1 and the blue trend line shifting towards 1 for high values of yearly income. This suggests that, as the yearly income increase, the probability of success in credit card application increases.</span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a>Now one question that might come to your mind (I had this question when I was learning regression) is why can't we apply linear regression if it is just 0 and 1 values for the response variable. So let us plot both linear and logistic regression for the above data.</span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-673"><a href="#cb53-673" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-674"><a href="#cb53-674" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-675"><a href="#cb53-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-678"><a href="#cb53-678" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the logistic model</span></span>
<span id="cb53-679"><a href="#cb53-679" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CreditCard, <span class="fu">aes</span>(income, <span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> F, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial)) <span class="sc">+</span></span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb53-685"><a href="#cb53-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span>
<span id="cb53-686"><a href="#cb53-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a>HA! If we got a similar trend line as that of the logistic model, then why bother with a logistic model? Well, hold your horses! If we take a closer look at the trend line, we can see that the red line overshoots the y-axis value of 1. This means we have a probability value greater than 1 which is absurd. Perhaps the best way to see why linear models don't work for binary response variables is by predicting values using them with values outside the dataset.</span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-695"><a href="#cb53-695" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-696"><a href="#cb53-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-699"><a href="#cb53-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb53-700"><a href="#cb53-700" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>((<span class="fu">as.numeric</span>(card) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">~</span> income, <span class="at">data =</span> CreditCard)</span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a><span class="co"># # Generating random income values</span></span>
<span id="cb53-704"><a href="#cb53-704" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb53-705"><a href="#cb53-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the values for linear and logistics</span></span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the 'type = response' to calculate probabilities</span></span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a>predict_values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predict_lm =</span> <span class="fu">predict</span>(model_lm, explorartory_values),</span>
<span id="cb53-710"><a href="#cb53-710" aria-hidden="true" tabindex="-1"></a>         <span class="at">predict_log =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb53-711"><a href="#cb53-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the predicted values as a line graph</span></span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predict_values, <span class="fu">aes</span>(income)) <span class="sc">+</span></span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> predict_values, <span class="fu">aes</span>(<span class="at">y =</span> predict_lm, <span class="at">col =</span> <span class="st">"linear"</span>)) <span class="sc">+</span></span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> predict_values, <span class="fu">aes</span>(<span class="at">y =</span> predict_log, <span class="at">col =</span> <span class="st">"logistic"</span>)) <span class="sc">+</span></span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-717"><a href="#cb53-717" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-718"><a href="#cb53-718" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Was the application for a credit card accepted?"</span>) <span class="sc">+</span></span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="st">"Distribution"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a>You can see that the predicted values using the linear model are going beyond 0 and 1 whereas the logistic model predicts values between 0 and 1. Also, notice the sigmoid curve or the S-shaped curve which is a characteristic of the logistic model. Thus for a binary response variable, logistic modelling is the best.</span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## Making predictions using a logistic model</span></span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-727"><a href="#cb53-727" aria-hidden="true" tabindex="-1"></a>Like in the linear model, we use the <span class="in">`predict()`</span> function to predict values using a logistics model. We can change the type of values we get from the <span class="in">`predict()`</span> function using the <span class="in">`type = `</span> argument. By default, the predict function outputs log odds ratio (which is <span class="in">`type = "link"`</span>), another option is <span class="in">`type = "response"`</span> which outputs probability values. Other ways for expressing predicted values from the model include 'odds ratio' and 'most likely outcomes.</span>
<span id="cb53-728"><a href="#cb53-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability values</span></span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a>One of the easier ways of expressing the predicted values from a logistic model. Simply it just calculates the probability of the levels in the response variable.</span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-737"><a href="#cb53-737" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-738"><a href="#cb53-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-739"><a href="#cb53-739" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb53-745"><a href="#cb53-745" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb53-746"><a href="#cb53-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the probability values</span></span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing probability values</span></span>
<span id="cb53-752"><a href="#cb53-752" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span>
<span id="cb53-753"><a href="#cb53-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the probability values</span></span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, probability)) <span class="sc">+</span></span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Probability values"</span>,</span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of application being accepted"</span>) <span class="sc">+</span></span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### Most likely outcome</span></span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a>This is the easiest way to express logistic model predicted values. It rescales the probability values into stating whether an event happens or not. Simply put, it rounds the probability values to give either 0 or 1.</span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the most likely values</span></span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb53-784"><a href="#cb53-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb53-785"><a href="#cb53-785" aria-hidden="true" tabindex="-1"></a>         <span class="at">most_likely =</span> <span class="fu">round</span>(probability))</span>
<span id="cb53-786"><a href="#cb53-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-787"><a href="#cb53-787" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing most likely values</span></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-790"><a href="#cb53-790" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the most likely values</span></span>
<span id="cb53-791"><a href="#cb53-791" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, most_likely)) <span class="sc">+</span></span>
<span id="cb53-792"><a href="#cb53-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-793"><a href="#cb53-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-794"><a href="#cb53-794" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Most likely values"</span>,</span>
<span id="cb53-795"><a href="#cb53-795" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-796"><a href="#cb53-796" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of predicted applications being accepted"</span>) <span class="sc">+</span></span>
<span id="cb53-797"><a href="#cb53-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-798"><a href="#cb53-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-799"><a href="#cb53-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-800"><a href="#cb53-800" aria-hidden="true" tabindex="-1"></a><span class="fu">### Odds ratio</span></span>
<span id="cb53-801"><a href="#cb53-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-802"><a href="#cb53-802" aria-hidden="true" tabindex="-1"></a>The odds ratio is calculated by taking the probability of success divided by the probability of losing. In simple terms, it tells the odds of one event happening compared to the other.</span>
<span id="cb53-803"><a href="#cb53-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-804"><a href="#cb53-804" aria-hidden="true" tabindex="-1"></a>$$Odds\,ratio = \frac{p(success)}{1-p(success)} = \frac{p(success)}{p(fail)}$$</span>
<span id="cb53-805"><a href="#cb53-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-806"><a href="#cb53-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-807"><a href="#cb53-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-808"><a href="#cb53-808" aria-hidden="true" tabindex="-1"></a>We can visualize this from the predicted values.</span>
<span id="cb53-809"><a href="#cb53-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-812"><a href="#cb53-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-813"><a href="#cb53-813" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-814"><a href="#cb53-814" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-815"><a href="#cb53-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-816"><a href="#cb53-816" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-817"><a href="#cb53-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-818"><a href="#cb53-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb53-819"><a href="#cb53-819" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-820"><a href="#cb53-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-821"><a href="#cb53-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb53-822"><a href="#cb53-822" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb53-823"><a href="#cb53-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-824"><a href="#cb53-824" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the odds ratio values</span></span>
<span id="cb53-825"><a href="#cb53-825" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb53-826"><a href="#cb53-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb53-827"><a href="#cb53-827" aria-hidden="true" tabindex="-1"></a>         <span class="at">odds_ratio =</span> probability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> probability))</span>
<span id="cb53-828"><a href="#cb53-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-829"><a href="#cb53-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing odds ratio values</span></span>
<span id="cb53-830"><a href="#cb53-830" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span>
<span id="cb53-831"><a href="#cb53-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-832"><a href="#cb53-832" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the odds ratio values</span></span>
<span id="cb53-833"><a href="#cb53-833" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, odds_ratio)) <span class="sc">+</span></span>
<span id="cb53-834"><a href="#cb53-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-835"><a href="#cb53-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-836"><a href="#cb53-836" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Odds ratio"</span>,</span>
<span id="cb53-837"><a href="#cb53-837" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-838"><a href="#cb53-838" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Odds ratio"</span>) <span class="sc">+</span></span>
<span id="cb53-839"><a href="#cb53-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-840"><a href="#cb53-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-841"><a href="#cb53-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-842"><a href="#cb53-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-843"><a href="#cb53-843" aria-hidden="true" tabindex="-1"></a>The plot has a horizontal line plotted with y = 0. The points on this line correspond to equal odds of being rejected and accepted for a credit card application (equal odds of winning and losing). The y values for example 1000 correspond to 1000 successes for every one failure in a credit card application. The plot suggests that after the 18,000 dollars yearly income mark, the odds of success to failure rise exponentially.</span>
<span id="cb53-844"><a href="#cb53-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-845"><a href="#cb53-845" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log odds ratio</span></span>
<span id="cb53-846"><a href="#cb53-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-847"><a href="#cb53-847" aria-hidden="true" tabindex="-1"></a>The log odds ratio is the log-transformed value of the odds ratio. We will see how this value is superior to all the other values when we plot the values. Since we are transforming the y-axis values to log, we convert the scale of the y-axis to log using the <span class="in">`scale_y_log10()`</span> function. By default, the <span class="in">`predict()`</span> function outputs log odds ratio.</span>
<span id="cb53-848"><a href="#cb53-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-851"><a href="#cb53-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-852"><a href="#cb53-852" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-853"><a href="#cb53-853" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-854"><a href="#cb53-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-855"><a href="#cb53-855" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-856"><a href="#cb53-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-857"><a href="#cb53-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Building models</span></span>
<span id="cb53-858"><a href="#cb53-858" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-859"><a href="#cb53-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-860"><a href="#cb53-860" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random income values</span></span>
<span id="cb53-861"><a href="#cb53-861" aria-hidden="true" tabindex="-1"></a>explorartory_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">income =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">2</span>))</span>
<span id="cb53-862"><a href="#cb53-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-863"><a href="#cb53-863" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the log odds ratio values</span></span>
<span id="cb53-864"><a href="#cb53-864" aria-hidden="true" tabindex="-1"></a>predicted_Values <span class="ot">&lt;-</span> explorartory_values <span class="sc">%&gt;%</span></span>
<span id="cb53-865"><a href="#cb53-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> <span class="fu">predict</span>(model_log, explorartory_values, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb53-866"><a href="#cb53-866" aria-hidden="true" tabindex="-1"></a>         <span class="at">odds_ratio =</span> probability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> probability),</span>
<span id="cb53-867"><a href="#cb53-867" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_odds_ratio =</span> <span class="fu">log</span>(odds_ratio),</span>
<span id="cb53-868"><a href="#cb53-868" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_odds_ratio_1 =</span> <span class="fu">predict</span>(model_log, explorartory_values))</span>
<span id="cb53-869"><a href="#cb53-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-870"><a href="#cb53-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing log odds ratio values</span></span>
<span id="cb53-871"><a href="#cb53-871" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_Values)</span>
<span id="cb53-872"><a href="#cb53-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-873"><a href="#cb53-873" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the log odds ratio values</span></span>
<span id="cb53-874"><a href="#cb53-874" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_Values, <span class="fu">aes</span>(income, odds_ratio)) <span class="sc">+</span></span>
<span id="cb53-875"><a href="#cb53-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-876"><a href="#cb53-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does income affect the success in accepting a credit card application?"</span>,</span>
<span id="cb53-877"><a href="#cb53-877" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Log Odds ratio"</span>,</span>
<span id="cb53-878"><a href="#cb53-878" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yearly income (in USD 10,000)"</span>,</span>
<span id="cb53-879"><a href="#cb53-879" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log Odds ratio"</span>) <span class="sc">+</span></span>
<span id="cb53-880"><a href="#cb53-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-881"><a href="#cb53-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb53-882"><a href="#cb53-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-883"><a href="#cb53-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-884"><a href="#cb53-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-885"><a href="#cb53-885" aria-hidden="true" tabindex="-1"></a>Log transforming the odds ratio values resulted in a linear trend line which is easier to understand the overall relationship. We can see that as yearly income increases, the probability of success in credit card application will also rise.</span>
<span id="cb53-886"><a href="#cb53-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-887"><a href="#cb53-887" aria-hidden="true" tabindex="-1"></a>Given below is the summary of the predicted value types and their usage concerning the audience in question. Some values like most likely outcomes might be best in explaining the trends in the data for non-experts or common people, whereas log odds might be best for experts.</span>
<span id="cb53-888"><a href="#cb53-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-889"><a href="#cb53-889" aria-hidden="true" tabindex="-1"></a>| Scale | Easier to explain values? | Easier to explain changes in the response variable? | Is it precise? |</span>
<span id="cb53-890"><a href="#cb53-890" aria-hidden="true" tabindex="-1"></a>|---|---|---|---|</span>
<span id="cb53-891"><a href="#cb53-891" aria-hidden="true" tabindex="-1"></a>| Probability | Yes | Not easy for x values in the middle | Yes |</span>
<span id="cb53-892"><a href="#cb53-892" aria-hidden="true" tabindex="-1"></a>| Most likely outcomes | Easiest out of all | Quickly compare high and low x values | No |</span>
<span id="cb53-893"><a href="#cb53-893" aria-hidden="true" tabindex="-1"></a>| Odds ratio | Kind of easy to explain.<span class="kw">&lt;br&gt;</span>Odds of one event against another | Not really | Yes |</span>
<span id="cb53-894"><a href="#cb53-894" aria-hidden="true" tabindex="-1"></a>| Log odds ratio | Log transformed values are harder to explain | Linear relation after log transformation<span class="kw">&lt;br&gt;</span>makes it easy to interpret changes | Yes |</span>
<span id="cb53-895"><a href="#cb53-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-896"><a href="#cb53-896" aria-hidden="true" tabindex="-1"></a>: Different scales of predicted values from a logistic model</span>
<span id="cb53-897"><a href="#cb53-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-898"><a href="#cb53-898" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding the summary of a logistic model</span></span>
<span id="cb53-899"><a href="#cb53-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-900"><a href="#cb53-900" aria-hidden="true" tabindex="-1"></a>Now let us look at the summary of the logistic model we built earlier.</span>
<span id="cb53-901"><a href="#cb53-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-904"><a href="#cb53-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-905"><a href="#cb53-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-906"><a href="#cb53-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-907"><a href="#cb53-907" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-908"><a href="#cb53-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-909"><a href="#cb53-909" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-910"><a href="#cb53-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-911"><a href="#cb53-911" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-912"><a href="#cb53-912" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> income, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-913"><a href="#cb53-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-914"><a href="#cb53-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing model outputs</span></span>
<span id="cb53-915"><a href="#cb53-915" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_log)</span>
<span id="cb53-916"><a href="#cb53-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-917"><a href="#cb53-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-918"><a href="#cb53-918" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/log_summary_1.png)</span></span>
<span id="cb53-919"><a href="#cb53-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-920"><a href="#cb53-920" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>Section 1 is the model formula we used to build the model.</span>
<span id="cb53-921"><a href="#cb53-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-922"><a href="#cb53-922" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>Section 2 is the quantile values of the residuals in the model, which is to check if the residuals are normally distributed.</span>
<span id="cb53-923"><a href="#cb53-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-924"><a href="#cb53-924" aria-hidden="true" tabindex="-1"></a><span class="ss">3.    </span>Section 3 outlines the model coefficients which are in log odds values which we discussed in detail above.</span>
<span id="cb53-925"><a href="#cb53-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-926"><a href="#cb53-926" aria-hidden="true" tabindex="-1"></a><span class="ss">4.    </span>Section 4. I don't know what these values are, so once I learn I will update this text.</span>
<span id="cb53-927"><a href="#cb53-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-928"><a href="#cb53-928" aria-hidden="true" tabindex="-1"></a><span class="ss">5.    </span>Section 5. I don't know what these values are, so once I learn I will update this text.</span>
<span id="cb53-929"><a href="#cb53-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-930"><a href="#cb53-930" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assessing logistic model fit</span></span>
<span id="cb53-931"><a href="#cb53-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-932"><a href="#cb53-932" aria-hidden="true" tabindex="-1"></a>To assess the performance of a logistic model we have several different metrics we can use that are different from the linear model metrics. Let us look at each of them.</span>
<span id="cb53-933"><a href="#cb53-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-934"><a href="#cb53-934" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion matrix</span></span>
<span id="cb53-935"><a href="#cb53-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-936"><a href="#cb53-936" aria-hidden="true" tabindex="-1"></a>The confusion matrix is a 2 by 2 matrix showcasing the number of correct predictions and no of wrong predictions.</span>
<span id="cb53-937"><a href="#cb53-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-938"><a href="#cb53-938" aria-hidden="true" tabindex="-1"></a>| Scale | Actually false | Actually true |</span>
<span id="cb53-939"><a href="#cb53-939" aria-hidden="true" tabindex="-1"></a>|---|---|---|</span>
<span id="cb53-940"><a href="#cb53-940" aria-hidden="true" tabindex="-1"></a>| Predicted false | True negative | False negative |</span>
<span id="cb53-941"><a href="#cb53-941" aria-hidden="true" tabindex="-1"></a>| Predicted true | False positive | True positive |</span>
<span id="cb53-942"><a href="#cb53-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-943"><a href="#cb53-943" aria-hidden="true" tabindex="-1"></a>: The framework of a confusion matrix</span>
<span id="cb53-944"><a href="#cb53-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-945"><a href="#cb53-945" aria-hidden="true" tabindex="-1"></a>Let us make a confusion matrix of a logistic model where credit card success (<span class="in">`card`</span>) is predicted by the number of major derogatory reports against the applicant (<span class="in">`reports`</span>).</span>
<span id="cb53-946"><a href="#cb53-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-949"><a href="#cb53-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-950"><a href="#cb53-950" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-951"><a href="#cb53-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-952"><a href="#cb53-952" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-953"><a href="#cb53-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-954"><a href="#cb53-954" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-955"><a href="#cb53-955" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-956"><a href="#cb53-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-957"><a href="#cb53-957" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb53-958"><a href="#cb53-958" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-959"><a href="#cb53-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-960"><a href="#cb53-960" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb53-961"><a href="#cb53-961" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb53-962"><a href="#cb53-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-963"><a href="#cb53-963" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb53-964"><a href="#cb53-964" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb53-965"><a href="#cb53-965" aria-hidden="true" tabindex="-1"></a>confusion_matrix</span>
<span id="cb53-966"><a href="#cb53-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-967"><a href="#cb53-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-968"><a href="#cb53-968" aria-hidden="true" tabindex="-1"></a>We have 1109 (104 + 1005) correct predictions, 18 false negatives and 192 false positives. We can plot the confusion matrix with the help of <span class="in">`{yardstick}`</span> and <span class="in">`{ggfortify}`</span> packages.</span>
<span id="cb53-969"><a href="#cb53-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-972"><a href="#cb53-972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-973"><a href="#cb53-973" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(yardstick)) <span class="fu">install.packages</span>(<span class="st">'yardstick'</span>)</span>
<span id="cb53-974"><a href="#cb53-974" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-975"><a href="#cb53-975" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-976"><a href="#cb53-976" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb53-977"><a href="#cb53-977" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb53-978"><a href="#cb53-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-979"><a href="#cb53-979" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-980"><a href="#cb53-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-981"><a href="#cb53-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-982"><a href="#cb53-982" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-983"><a href="#cb53-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-984"><a href="#cb53-984" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb53-985"><a href="#cb53-985" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-986"><a href="#cb53-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-987"><a href="#cb53-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb53-988"><a href="#cb53-988" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb53-989"><a href="#cb53-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-990"><a href="#cb53-990" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb53-991"><a href="#cb53-991" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb53-992"><a href="#cb53-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-993"><a href="#cb53-993" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb53-994"><a href="#cb53-994" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb53-995"><a href="#cb53-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-996"><a href="#cb53-996" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the confusion matrix</span></span>
<span id="cb53-997"><a href="#cb53-997" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(conf_matrix) <span class="sc">+</span></span>
<span id="cb53-998"><a href="#cb53-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mosaic plot of confusion matrix"</span>,</span>
<span id="cb53-999"><a href="#cb53-999" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual value"</span>,</span>
<span id="cb53-1000"><a href="#cb53-1000" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted value"</span>) <span class="sc">+</span></span>
<span id="cb53-1001"><a href="#cb53-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb53-1002"><a href="#cb53-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1003"><a href="#cb53-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1004"><a href="#cb53-1004" aria-hidden="true" tabindex="-1"></a>Now let us see how to interpret this plot. In the x-axis, you can see the actual values, 0 corresponds to failure in getting the credit card application accepted and 1 corresponds to the success of the same. The width of the bars corresponds to the proportion of the values of 0 and 1 in the dataset. There are more success values than failure values. Now, for the corresponding actual value, we have the bar split into respective predicted values. For actual failure values, we have a lot of predicted values falsely marking it as success. On the other hand, for the actual success value, most of the predicted values were correct. Thus the first bar under 0 tells us about the false positive cases and the second bar under 1 tells us about the false negative cases. We can see that our model has more false positive cases than false positive cases which is what we saw in the confusion matrix.</span>
<span id="cb53-1005"><a href="#cb53-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1006"><a href="#cb53-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accuracy</span></span>
<span id="cb53-1007"><a href="#cb53-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1008"><a href="#cb53-1008" aria-hidden="true" tabindex="-1"></a>Accuracy is simply the proportion of correct predictions compared to all predictions.</span>
<span id="cb53-1009"><a href="#cb53-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1010"><a href="#cb53-1010" aria-hidden="true" tabindex="-1"></a>$$Accuracy = \frac{true\,positives + true\,negatives}{total\,predictions}$$</span>
<span id="cb53-1011"><a href="#cb53-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1012"><a href="#cb53-1012" aria-hidden="true" tabindex="-1"></a>We can find the accuracy from the summary of the confusion matrix we made using the <span class="in">`summary()`</span> and <span class="in">`slice()`</span> functions. The <span class="in">`event_level = "second"`</span> is to denote the second column of the confusion matrix as the success value which is 1.</span>
<span id="cb53-1013"><a href="#cb53-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1016"><a href="#cb53-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1017"><a href="#cb53-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-1018"><a href="#cb53-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb53-1019"><a href="#cb53-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1020"><a href="#cb53-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-1021"><a href="#cb53-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1022"><a href="#cb53-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-1023"><a href="#cb53-1023" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-1024"><a href="#cb53-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1025"><a href="#cb53-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb53-1026"><a href="#cb53-1026" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-1027"><a href="#cb53-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1037"><a href="#cb53-1037" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding accuracy of the model</span></span>
<span id="cb53-1038"><a href="#cb53-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb53-1039"><a href="#cb53-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a>We got an accuracy value of 84% for the model we built.</span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sensitivity</span></span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a>Sensitivity tells us the proportion of true positives. Higher values suggest that there are fewer false negatives.</span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a>$$Sensitivity = \frac{true\,positives}{false\,negatives + true\,positives}$$</span>
<span id="cb53-1048"><a href="#cb53-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1057"><a href="#cb53-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-1058"><a href="#cb53-1058" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1066"><a href="#cb53-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb53-1067"><a href="#cb53-1067" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb53-1070"><a href="#cb53-1070" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb53-1071"><a href="#cb53-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1072"><a href="#cb53-1072" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding sensitivity of the model</span></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">3</span>)</span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a>We have around very 2% false negatives (100 - 98).</span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">### Specificity</span></span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a>Sensitivity tells us the proportion of true negatives. Higher values suggest that there are fewer false positives.</span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a>$$Specificity = \frac{true\,negatives}{false\,positives + true\,negatives}$$</span>
<span id="cb53-1083"><a href="#cb53-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb53-1089"><a href="#cb53-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1090"><a href="#cb53-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CreditCard"</span>)</span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a logistic model</span></span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(card <span class="sc">~</span> reports, <span class="at">data =</span> CreditCard, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb53-1094"><a href="#cb53-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1095"><a href="#cb53-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting actual values</span></span>
<span id="cb53-1096"><a href="#cb53-1096" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(CreditCard<span class="sc">$</span>card) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb53-1097"><a href="#cb53-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1098"><a href="#cb53-1098" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting predicted values</span></span>
<span id="cb53-1099"><a href="#cb53-1099" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">fitted</span>(model_log))</span>
<span id="cb53-1100"><a href="#cb53-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1101"><a href="#cb53-1101" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a confusion matrix</span></span>
<span id="cb53-1102"><a href="#cb53-1102" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_values, actual_values)</span>
<span id="cb53-1103"><a href="#cb53-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1104"><a href="#cb53-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the confusion matrix into an object that can be plotted</span></span>
<span id="cb53-1105"><a href="#cb53-1105" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(confusion_matrix)</span>
<span id="cb53-1106"><a href="#cb53-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1107"><a href="#cb53-1107" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding specificity of the model</span></span>
<span id="cb53-1108"><a href="#cb53-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conf_matrix, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">4</span>)</span>
<span id="cb53-1109"><a href="#cb53-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1110"><a href="#cb53-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1111"><a href="#cb53-1111" aria-hidden="true" tabindex="-1"></a>We have around 64% false positives (100 - 35).</span>
<span id="cb53-1112"><a href="#cb53-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1113"><a href="#cb53-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb53-1114"><a href="#cb53-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1115"><a href="#cb53-1115" aria-hidden="true" tabindex="-1"></a>Hurray! We completed the basics of regression using R. This tutorial will lay the foundations for learning statistical modelling which I have covered in the tutorial section. Let us recap what we studied in this tutorial;</span>
<span id="cb53-1116"><a href="#cb53-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1117"><a href="#cb53-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">1.    </span>What is linear regression / linear model</span>
<span id="cb53-1118"><a href="#cb53-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1119"><a href="#cb53-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">2.    </span>How to build a linear model and use it to predict</span>
<span id="cb53-1120"><a href="#cb53-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1121"><a href="#cb53-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">3.    </span>Understanding the linear model summary output</span>
<span id="cb53-1122"><a href="#cb53-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1123"><a href="#cb53-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">4.    </span>How to view model outputs as data frames using the <span class="in">`{broom}`</span> package</span>
<span id="cb53-1124"><a href="#cb53-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1125"><a href="#cb53-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">5.    </span>Assessing linear model performance using; R-squared, Residual standard error and Root mean square error</span>
<span id="cb53-1126"><a href="#cb53-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1127"><a href="#cb53-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">6.    </span>Visualizing model fit using; Residual vs. Fitted plot, Q-Q plot and Scale-location plot</span>
<span id="cb53-1128"><a href="#cb53-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1129"><a href="#cb53-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">7.    </span>Analysing outliers using; Leverage (hat values) and Influence (cook's distance)</span>
<span id="cb53-1130"><a href="#cb53-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1131"><a href="#cb53-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">8.    </span>What is logistic regression / logistic model</span>
<span id="cb53-1132"><a href="#cb53-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1133"><a href="#cb53-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">9.    </span>How to build a logistic model</span>
<span id="cb53-1134"><a href="#cb53-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1135"><a href="#cb53-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">10.   </span>Different types of predictions using the logistic model: Probability values, Most like outcomes, Odds ratio and Log odds ratio</span>
<span id="cb53-1136"><a href="#cb53-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1137"><a href="#cb53-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">11.   </span>Understanding the logistic model summary output</span>
<span id="cb53-1138"><a href="#cb53-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1139"><a href="#cb53-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">12.   </span>Assessing logistic model performance using; Confusion matrix, Accuracy, Sensitivity and Specificity</span>
<span id="cb53-1140"><a href="#cb53-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1141"><a href="#cb53-1141" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Do not forget to put flag counter --&gt;</span></span>
<span id="cb53-1142"><a href="#cb53-1142" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">hidden</span> <span class="er">href</span><span class="ot">=</span><span class="st">"https://info.flagcounter.com/ynrK"</span><span class="kw">&gt;&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://s11.flagcounter.com/count2/ynrK/bg_000000/txt_FFFFFF/border_F0F0F0/columns_5/maxflags_25/viewers_0/labels_1/pageviews_1/flags_0/percent_0/"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Flag Counter"</span> <span class="er">border</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">/&gt;&lt;/a&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Blog made using <a href="https://quarto.org/">Quarto®</a> with ❤️, by Jewel Johnson.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jeweljohnsonj">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jeweljohnsonj">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:jewel.johnson@bsu.edu">
      <i class="bi bi-briefcase" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:jeweljohnsonj@gmail.com">
      <i class="bi bi-house" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<div class="page-columns page-rows-contents page-layout-article"><div class="social-share"><a href="https://twitter.com/share?url=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html&amp;text=Introduction to Regression in R" target="_blank" class="twitter"><i class="fab fa-twitter fa-fw fa-lg"></i></a><a href="https://www.linkedin.com/shareArticle?url=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html&amp;title=Introduction to Regression in R" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a>  <a href="mailto:?subject=Introduction to Regression in R&amp;body=Check out this link:https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html" target="_blank" class="email"><i class="fa-solid fa-envelope fa-fw fa-lg"></i></a><a href="https://www.facebook.com/sharer.php?u=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html" target="_blank" class="facebook"><i class="fab fa-facebook-f fa-fw fa-lg"></i></a><a href="https://reddit.com/submit?url=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html&amp;title=Introduction to Regression in R" target="_blank" class="reddit">   <i class="fa-brands fa-reddit-alien fa-fw fa-lg"></i></a><a href="https://www.stumbleupon.com/submit?url=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html&amp;title=Introduction to Regression in R" target="_blank" class="stumbleupon"><i class="fa-brands fa-stumbleupon fa-fw fa-lg"></i></a><a href="https://www.tumblr.com/share/link?url=https://sciquest.netlify.app/tutorials/stat_model/intro_reg.html&amp;name=Introduction to Regression in R" target="_blank" class="tumblr"><i class="fa-brands fa-tumblr fa-fw fa-lg"></i></a></div></div>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>