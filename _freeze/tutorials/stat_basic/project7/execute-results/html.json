{
  "hash": "eca8610b19e6cd002a3451cbd1fef5b7",
  "result": {
    "markdown": "---\ntitle: \"Chapter 7: Parametric tests and assumptions\"\ndescription: \"Learn about parametric tests and assumptions\"\ndate: \"05/21/2022\"\nformat: html\ncategories: [statistics, basic statistics]\n---\n\n\n\n\n::: {layout-ncol=\"1\"}\n![](images/para1.jpg){.preview-image}\n:::\n\n## Parametric test assumptions\n\nParametric tests can only be used in datasets having two groups, which fulfill the following conditions;\n\n1.  The data should follow a normal distribution\n2.  The groups should have equal variances (homoscedasticity)\n3.  The dependent variable should be of an ordinal scale, which means it can be arranged in a defined order\n4.  The two groups should be independent of each other\n\nNow we will learn how to do some of the parametric tests in R. For this tutorial, we will be using the `penguins` dataset from the `{palmerpenguins}` package in R. Before we begin trying out the test, we will first have to check if the data is normally distributed. Using various normality tests, we can check if our data is normally distributed. On the other hand, we can also check if our data is normally distributed by simply plotting the data or by using a `qq-plot`.\n\n### Density plot, qq-plot and residual plot\n\nNow we will plot a histogram of body mass in Chinstrap penguins.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"palmerpenguins\")\n#install.packages(\"tidyverse\")\n#install.packages(\"ggpubr\")\n\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nlibrary(ggpubr)\n\npenguins %>% filter(species == \"Chinstrap\") %>% ggplot(aes(x = body_mass_g)) + \n  xlab(\"Body Mass (g)\") + ylab(\"Frequency\") + ggtitle(\"Body mass distribution\") + \n   geom_histogram(bins = 25) + \n  labs(subtitle = paste0(\"N=\",penguins %>% filter(species == \"Chinstrap\") %>% nrow())) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](project7_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe plot is similar to a normal distribution. We can also see the same by plotting a `qq-plot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"palmerpenguins\")\n#install.packages(\"tidyverse\")\n#install.packages(\"ggpubr\")\n\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nlibrary(ggpubr)\n\npenguins %>% filter(species == \"Chinstrap\") %>% \n  ggqqplot(x = \"body_mass_g\", color = \"species\")\n```\n\n::: {.cell-output-display}\n![](project7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nIf the `qq-plot` shows data points aligning within the reference line, then we can conclude that the data points follow a normal distribution.\n\nWe can also test the same by plotting a residual plot which shows the distribution of residual distances of the data points. Residual distance shows how far each point is from the mean value.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"palmerpenguins\")\n#install.packages(\"tidyverse\")\n#install.packages(\"ggpubr\")\n\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nlibrary(ggpubr)\n\npenguins %>% filter(species == \"Chinstrap\") %>% ggplot(aes(x = body_mass_g)) + \n  xlab(\"Body Mass (g)\") + ylab(\"Residual\") + ggtitle(\"Body mass distribution\") + \n   geom_density() + \n  labs(subtitle = paste0(\"N=\",penguins %>% filter(species == \"Chinstrap\") %>% nrow())) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](project7_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAs we found earlier, the plot resembles a normal distribution.\n\nNow let us do some normality tests to check if the data we have is following a normal distribution. In normality tests, the null hypothesis is that the distribution is normal and the alternate hypothesis is that it is not.\n\n### Shapiro-Wilk's test\n\nWe will be doing the `Kolmogorov-Smirnov (K-S) normality test` and `Shapiro-Wilk’s test`. The Kolmogorov--Smirnov test is best for sample sizes ≥ 50 and Shapiro-Wilk's test is best for \\< 50.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen_chin <- penguins %>% filter(species == \"Chinstrap\")\nshapiro.test(pen_chin$body_mass_g)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  pen_chin$body_mass_g\nW = 0.98449, p-value = 0.5605\n```\n:::\n:::\n\n\nFrom the output, the p-value \\> 0.05 implies that the distribution of the data is not significantly different from a normal distribution. In other words, we can assume normality.\n\n### Kolmogorov-Smirnov (K-S) normality test\n\nThe Kolmogorov-Smirnov test requires a continuous distribution to function properly. So let us do the test on dummy data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\nx <- rnorm(50)\n\nks.test(x,\"pnorm\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tExact one-sample Kolmogorov-Smirnov test\n\ndata:  x\nD = 0.073034, p-value = 0.9347\nalternative hypothesis: two-sided\n```\n:::\n:::\n\n\nAs p \\> 0.05, we can confirm that the data is normally distributed.\n\n## Parametric test\n\n### one sample t-test\n\nThe student's t-test is a very popular parametric. In the following example, we will be doing a one-sample t-test. We will be checking if the body masses of Gentoo penguins are significantly different from 4500g.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen_gen <- penguins %>% filter(species==\"Gentoo\")\n# one sample t-test\nt.test(pen_gen$body_mass_g, mu = 4500)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  pen_gen$body_mass_g\nt = 12.672, df = 122, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 4500\n95 percent confidence interval:\n 4986.034 5165.998\nsample estimates:\nmean of x \n 5076.016 \n```\n:::\n:::\n\n\nSo the body masses of Gentoo are significantly large than 4500g.\n\n### two sample t-test\n\nIf we are comparing the means of two groups with equal variance, then we do a two-sample t-test. We will compare the body weights of Gentoo to Chinstrap species and see if their mean body masses differ significantly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen_gen <- penguins %>% filter(species==\"Gentoo\")\npen_chin <- penguins %>% filter(species==\"Chinstrap\")\n# two sample t-test\nt.test(pen_gen$body_mass_g, pen_chin$body_mass_g, var.equal = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  pen_gen$body_mass_g and pen_chin$body_mass_g\nt = 19.103, df = 189, p-value < 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 1204.258 1481.598\nsample estimates:\nmean of x mean of y \n 5076.016  3733.088 \n```\n:::\n:::\n\n\nThe test results show that the body masses of these two species of penguins differ significantly from each other.\n\n### welsh's t-test\n\nNow, normally we need to have the variances of two groups the same to perform a two-sample t-test. If the variances are not the same, then we could still do a t-test. For Welch's t-test, variance doesn't need to be the same for the two groups in question.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen_gen <- penguins %>% filter(species==\"Gentoo\")\npen_chin <- penguins %>% filter(species==\"Chinstrap\")\n# welsh's t-test\nt.test(pen_gen$body_mass_g, pen_chin$body_mass_g)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  pen_gen$body_mass_g and pen_chin$body_mass_g\nt = 20.628, df = 170.4, p-value < 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 1214.416 1471.440\nsample estimates:\nmean of x mean of y \n 5076.016  3733.088 \n```\n:::\n:::\n\n\n### paired t-test\n\nNow if we have paired data, then to compare between two groups, we can do a paired t-test. Paired data means that the data in the two groups came from the same source. Here we will be comparing Gentoo penguin bill lengths versus bill depth. Here both the bill length and bill depth are measured from the same set of individuals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npen_gen <- penguins %>% filter(species==\"Gentoo\")\n# paired t-test\nt.test(pen_gen$bill_length_mm, pen_gen$bill_depth_mm, paired = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  pen_gen$bill_length_mm and pen_gen$bill_depth_mm\nt = 140.73, df = 122, p-value < 2.2e-16\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 32.06527 32.98026\nsample estimates:\nmean difference \n       32.52276 \n```\n:::\n:::\n\n\n## References\n\n1.  Ghasemi, A., & Zahediasl, S. (2012). Normality tests for statistical analysis: a guide for non-statisticians. International journal of endocrinology and metabolism, 10(2), 486--489. https://doi.org/10.5812/ijem.3505 [Link](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3693611/)\n\n2.  Livingston, E. H. (2004). Who was student and why do we care so much about his T-test?1. Journal of Surgical Research, 118(1), 58--65. https://doi.org/10.1016/j.jss.2004.02.003 [Link](https://www.sciencedirect.com/science/article/abs/pii/S0022480404000496)\n\n#### Last updated on {.unnumbered .unlisted}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2022-08-04 01:36:07 IST\"\n```\n:::\n:::\n\n\n<a hidden href=\"https://info.flagcounter.com/ynrK\"><img src=\"https://s11.flagcounter.com/count2/ynrK/bg_000000/txt_FFFFFF/border_F0F0F0/columns_5/maxflags_25/viewers_0/labels_1/pageviews_1/flags_0/percent_0/\" alt=\"Flag Counter\" border=\"0\"/></a>\n",
    "supporting": [
      "project7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}